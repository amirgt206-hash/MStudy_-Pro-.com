<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6a11cb">
    <meta name="description" content="Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ - Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø´Ø±Ú©Ø§Ø¦ÛŒ">
    
    <title>MStudy Pro | Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
    
    <!-- Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ Ùˆ ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* ============================================
           Ù…ØªØºÛŒØ±Ù‡Ø§ Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ
           ============================================ */
        :root {
            --primary: #6a11cb;
            --primary-light: #8a4bff;
            --secondary: #ff6b6b;
            --success: #4cd964;
            --warning: #ffd166;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --card-bg: #ffffff;
            --text-dark: #333333;
            --text-light: #f8f9fa;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 12px;
            --glass: rgba(255, 255, 255, 0.1);
        }

        /* ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù */
        [data-theme="nature"] {
            --primary: #2ecc71;
            --primary-light: #27ae60;
            --secondary: #3498db;
            --success: #2ecc71;
            --warning: #f1c40f;
        }

        [data-theme="energy"] {
            --primary: #ff9a00;
            --primary-light: #ff5e00;
            --secondary: #ff4757;
            --success: #00d2d3;
            --warning: #ff9f1a;
        }

        [data-theme="professional"] {
            --primary: #2c3e50;
            --primary-light: #34495e;
            --secondary: #7f8c8d;
            --success: #3498db;
            --warning: #f39c12;
        }

        [data-theme="calm"] {
            --primary: #8e44ad;
            --primary-light: #9b59b6;
            --secondary: #16a085;
            --success: #9b59b6;
            --warning: #f1c40f;
        }

        /* ØªÙ… ØªØ§Ø±ÛŒÚ© */
        .dark-mode {
            --primary: #8a4bff;
            --primary-light: #9d65ff;
            --card-bg: #2d2d3d;
            --light: #1a1a2e;
            --text-dark: #f0f0f0;
            --text-light: #e0e0e0;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            --glass: rgba(0, 0, 0, 0.2);
        }

        /* Ø±ÛŒØ³Øª Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background: var(--light);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            font-size: 14px;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        /* ============================================
           ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ÛŒ Ø¬Ø°Ø§Ø¨
           ============================================ */
        #splash-screen {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        #splash-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .splash-logo {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            animation: bounce 1.5s infinite;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .splash-logo i {
            font-size: 50px;
            color: var(--primary);
        }

        .splash-text {
            text-align: center;
            color: white;
        }

        .splash-text h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .splash-text p {
            font-size: 16px;
            opacity: 0.9;
        }

        .splash-loader {
            margin-top: 30px;
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ============================================
           Ù‡Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø¯ÙˆØ³ØªØ§Ù†Ù‡
           ============================================ */
        .header {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            height: 60px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 16px;
            box-shadow: var(--shadow);
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .dark-mode .header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .header-title {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .logo-text h1 {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text p {
            font-size: 11px;
            color: var(--text-dark);
            opacity: 0.7;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: rgba(0,0,0,0.05);
            color: var(--text-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .dark-mode .header-btn {
            background: rgba(255,255,255,0.05);
        }

        .header-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .dark-mode .header-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .header-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ============================================
           Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÛŒÛŒÙ†ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
           ============================================ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            right: 0;
            left: 0;
            height: 65px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            border-top: 1px solid rgba(0,0,0,0.1);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .dark-mode .bottom-nav {
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: var(--text-dark);
            opacity: 0.5;
            transition: var(--transition);
            padding: 8px 0;
            font-size: 11px;
            position: relative;
        }

        .nav-item.active {
            opacity: 1;
            color: var(--primary);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            right: 50%;
            transform: translateX(50%);
            width: 30px;
            height: 3px;
            background: var(--primary);
            border-radius: 0 0 3px 3px;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* ============================================
           Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ
           ============================================ */
        .main-content {
            padding: 80px 0 75px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .page {
            display: none;
            padding: 0 16px;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ============================================
           Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
           ============================================ */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .dark-mode .card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        /* ============================================
           ØªØ§ÛŒÙ…Ø± Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ
           ============================================ */
        .timer-display {
            font-size: 72px;
            font-weight: 700;
            text-align: center;
            margin: 20px 0;
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
        }

        .timer-mode {
            text-align: center;
            margin-bottom: 20px;
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            cursor: pointer;
            user-select: none;
            transition: var(--transition);
            padding: 5px 10px;
            border-radius: 8px;
        }

        .timer-mode:hover {
            background: rgba(106, 17, 203, 0.1);
        }

        .timer-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 24px 0;
        }

        .btn {
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
            outline: none;
            -webkit-appearance: none;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 4px 15px rgba(106, 17, 203, 0.2);
        }

        .btn-secondary {
            background: rgba(106, 17, 203, 0.1);
            color: var(--primary);
        }

        .btn-danger {
            background: rgba(255, 107, 107, 0.1);
            color: var(--secondary);
        }

        .btn-success {
            background: rgba(76, 217, 100, 0.1);
            color: var(--success);
        }

        .timer-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 24px;
        }

        .stat-item {
            background: rgba(0,0,0,0.02);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
        }

        .dark-mode .stat-item {
            background: rgba(255,255,255,0.05);
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--primary);
        }

        /* ============================================
           Ø¬Ù…Ù„Ø§Øª Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ
           ============================================ */
        .quote-box {
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.1), rgba(37, 117, 252, 0.1));
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            text-align: center;
            border-right: 4px solid var(--primary);
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
        }

        .quote-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(106, 17, 203, 0.15);
        }

        .quote-text {
            font-size: 16px;
            font-style: italic;
            line-height: 1.6;
            margin-bottom: 12px;
            color: var(--text-dark);
        }

        .quote-author {
            font-weight: 600;
            color: var(--primary);
            font-size: 14px;
        }

        /* ============================================
           Ø¯Ø±Ø®Øª Ù¾ÛŒØ´Ø±ÙØª
           ============================================ */
        .tree-container {
            text-align: center;
            padding: 20px 0;
        }

        .tree-icon {
            font-size: 80px;
            margin-bottom: 16px;
            transition: var(--transition);
            display: inline-block;
            cursor: pointer;
            user-select: none;
        }

        .tree-level {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .progress-container {
            width: 100%;
            height: 12px;
            background: rgba(0,0,0,0.1);
            border-radius: 6px;
            overflow: hidden;
            margin: 16px 0;
        }

        .dark-mode .progress-container {
            background: rgba(255,255,255,0.1);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 14px;
            color: var(--text-dark);
            opacity: 0.8;
        }

        /* ============================================
           Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§
           ============================================ */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .achievement-item {
            background: rgba(0,0,0,0.02);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            transition: var(--transition);
            border: 2px solid transparent;
            cursor: pointer;
            user-select: none;
        }

        .dark-mode .achievement-item {
            background: rgba(255,255,255,0.05);
        }

        .achievement-item.unlocked {
            border-color: var(--primary);
            background: rgba(106, 17, 203, 0.1);
        }

        .achievement-item.unlocked:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(106, 17, 203, 0.2);
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .achievement-title {
            font-weight: 600;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .achievement-desc {
            font-size: 10px;
            opacity: 0.7;
        }

        /* ============================================
           Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¯Ø±Ø³ÛŒ
           ============================================ */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            padding-bottom: 12px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .dark-mode .tabs {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .tab {
            padding: 10px 16px;
            background: transparent;
            border: none;
            color: var(--text-dark);
            opacity: 0.5;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            border-radius: 20px;
            transition: var(--transition);
        }

        .tab.active {
            opacity: 1;
            background: rgba(106, 17, 203, 0.1);
            color: var(--primary);
        }

        .upload-area {
            border: 2px dashed rgba(106, 17, 203, 0.3);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:active {
            border-color: var(--primary);
            background: rgba(106, 17, 203, 0.05);
        }

        .upload-area i {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 12px;
            opacity: 0.5;
        }

        .file-list {
            max-height: 300px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(0,0,0,0.02);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .dark-mode .file-item {
            background: rgba(255,255,255,0.05);
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: rgba(106, 17, 203, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            margin-left: 12px;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 500;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-size {
            font-size: 12px;
            color: var(--text-dark);
            opacity: 0.5;
        }

        /* ============================================
           Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ØµØ¯Ø§Ù‡Ø§ - Ø­Ø°Ù Ú©Ø§Ù…Ù„
           ============================================ */

        /* ============================================
           Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§ Ùˆ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§
           ============================================ */
        .notifications-list {
            max-height: 400px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .notification-item {
            padding: 16px;
            background: rgba(0,0,0,0.02);
            border-radius: 10px;
            margin-bottom: 8px;
            border-right: 3px solid var(--primary);
            position: relative;
        }

        .dark-mode .notification-item {
            background: rgba(255,255,255,0.05);
        }

        .notification-item.unread {
            background: rgba(106, 17, 203, 0.1);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .notification-title {
            font-weight: 600;
            flex: 1;
        }

        .notification-time {
            font-size: 12px;
            color: var(--text-dark);
            opacity: 0.5;
            margin-right: 8px;
        }

        .notification-message {
            font-size: 14px;
            line-height: 1.4;
        }

        .notification-actions {
            position: absolute;
            left: 16px;
            top: 16px;
            display: flex;
            gap: 8px;
        }

        .notification-btn {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            border: none;
            background: rgba(0,0,0,0.05);
            color: var(--text-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .dark-mode .notification-btn {
            background: rgba(255,255,255,0.05);
        }

        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ */
        .reminder-settings {
            background: rgba(0,0,0,0.02);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .dark-mode .reminder-settings {
            background: rgba(255,255,255,0.05);
        }

        .reminder-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .reminder-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .reminder-time {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-dark);
            font-family: inherit;
        }

        .dark-mode .reminder-time {
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* ============================================
           ØªÙ†Ø¸ÛŒÙ…Ø§Øª
           ============================================ */
        .settings-list {
            background: rgba(0,0,0,0.02);
            border-radius: 12px;
            overflow: hidden;
        }

        .dark-mode .settings-list {
            background: rgba(255,255,255,0.05);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .dark-mode .setting-item {
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .setting-icon {
            width: 36px;
            height: 36px;
            background: rgba(106, 17, 203, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªÙ… */
        .theme-selector {
            display: flex;
            gap: 10px;
            margin-top: 16px;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .theme-option {
            flex: 0 0 auto;
            width: 60px;
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            position: relative;
        }

        .theme-option:hover {
            transform: scale(1.05);
        }

        .theme-option.active {
            border-color: var(--primary);
        }

        .theme-option[data-theme="default"] {
            background: linear-gradient(135deg, #6a11cb, #8a4bff);
        }

        .theme-option[data-theme="nature"] {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .theme-option[data-theme="energy"] {
            background: linear-gradient(135deg, #ff9a00, #ff5e00);
        }

        .theme-option[data-theme="professional"] {
            background: linear-gradient(135deg, #2c3e50, #34495e);
        }

        .theme-option[data-theme="calm"] {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }

        .theme-check {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--primary);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* ============================================
           Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§
           ============================================ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            padding: 16px;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow: hidden;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dark-mode .modal-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: none;
            background: rgba(0,0,0,0.05);
            color: var(--text-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .dark-mode .modal-close {
            background: rgba(255,255,255,0.05);
        }

        .modal-body {
            padding: 20px;
            overflow-y: auto;
            max-height: calc(90vh - 80px);
            -webkit-overflow-scrolling: touch;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-dark);
            font-family: inherit;
            font-size: 14px;
        }

        .dark-mode .form-group input,
        .dark-mode .form-group textarea,
        .dark-mode .form-group select {
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* ============================================
           Ù„ÙˆØ¯Ø± Ùˆ Ø§Ø³Ú©Ù„ØªÙˆÙ†
           ============================================ */
        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(0,0,0,0.05) 25%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.05) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: 8px;
        }

        .dark-mode .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ============================================
           Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ØªÙˆØ³Øª
           ============================================ */
        .notification-toast {
            position: fixed;
            top: 80px;
            right: 16px;
            left: 16px;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            z-index: 3000;
            transform: translateY(-100%);
            opacity: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .notification-toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .notification-content {
            flex: 1;
        }

        /* ============================================
           ÙÙˆØªÙˆ Ø¨Ø§ Ø§Ù…Ø¶Ø§ÛŒ Ø³Ø§Ø²Ù†Ø¯Ù‡
           ============================================ */
        .creator-footer {
            text-align: center;
            padding: 30px 16px;
            color: var(--text-dark);
            opacity: 0.7;
            font-size: 12px;
            margin-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .dark-mode .creator-footer {
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .creator-signature {
            font-family: inherit;
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-top: 8px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ============================================
           Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ùˆ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø¯ÙˆØ³ØªØ§Ù†Ù‡
           ============================================ */
        @media (max-width: 480px) {
            .timer-display {
                font-size: 60px;
            }
            
            .timer-controls {
                grid-template-columns: 1fr;
            }
            
            .achievements-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .main-content {
                padding: 100px 0;
            }
            
            .page {
                padding: 0 24px;
            }
            
            .card {
                padding: 24px;
                margin-bottom: 24px;
            }
        }

        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ù„Ù…Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        @media (hover: none) and (pointer: coarse) {
            .btn,
            .nav-item,
            .header-btn {
                cursor: default;
            }
            
            .btn:active,
            .nav-item:active,
            .header-btn:active {
                opacity: 0.7;
            }
        }

        /* Ù¾ÛŒØ´Ú¯ÛŒØ±ÛŒ Ø§Ø² Ø²ÙˆÙ… Ø¯Ø± input Ø¯Ø± iOS */
        input,
        textarea,
        select {
            font-size: 16px;
        }

        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø±Ø§ÛŒ iOS */
        .file-list,
        .notifications-list,
        .modal-body {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        /* Ø­Ø§Ø´ÛŒÙ‡ Ø§ÛŒÙ…Ù† Ø¨Ø±Ø§ÛŒ notch */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }

        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
</head>
<body data-theme="default">
    <!-- ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ÛŒ Ø¬Ø°Ø§Ø¨ -->
    <div id="splash-screen">
        <div class="splash-logo">
            <i class="fas fa-brain"></i>
        </div>
        <div class="splash-text">
            <h1>MStudy Pro</h1>
            <p>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</p>
        </div>
        <div class="splash-loader"></div>
    </div>

    <!-- Ù‡Ø¯Ø± -->
    <header class="header safe-area-top">
        <div class="header-title">
            <div class="logo-icon">
                <i class="fas fa-brain"></i>
            </div>
            <div class="logo-text">
                <h1>MStudy Pro</h1>
                <p>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</p>
            </div>
        </div>
        <div class="header-actions">
            <button class="header-btn" id="themeToggle" aria-label="ØªØºÛŒÛŒØ± ØªÙ…">
                <i class="fas fa-moon"></i>
            </button>
            <button class="header-btn" id="syncBtn" aria-label="Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ">
                <i class="fas fa-sync-alt"></i>
            </button>
            <button class="header-btn" id="notificationBtn" aria-label="Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notificationCount" style="display: none;">0</span>
            </button>
        </div>
    </header>

    <!-- Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÛŒÛŒÙ†ÛŒ -->
    <nav class="bottom-nav safe-area-bottom">
        <a href="#" class="nav-item active" data-page="dashboard">
            <i class="fas fa-home nav-icon"></i>
            <span>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
        </a>
        <a href="#" class="nav-item" data-page="library">
            <i class="fas fa-book nav-icon"></i>
            <span>Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡</span>
        </a>
        <a href="#" class="nav-item" data-page="focus">
            <i class="fas fa-headphones nav-icon"></i>
            <span>ØªÙ…Ø±Ú©Ø²</span>
        </a>
        <a href="#" class="nav-item" data-page="notifications">
            <i class="fas fa-bell nav-icon"></i>
            <span>ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ</span>
        </a>
        <a href="#" class="nav-item" data-page="settings">
            <i class="fas fa-cog nav-icon"></i>
            <span>ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
        </a>
    </nav>

    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
    <main class="main-content">
        <!-- ØµÙØ­Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ -->
        <section id="dashboard-page" class="page active">
            <!-- Ø¬Ù…Ù„Ø§Øª Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-quote-right"></i>
                        Ø§Ù†Ú¯ÛŒØ²Ù‡ Ø±ÙˆØ²
                    </div>
                    <div>
                        <button class="btn btn-secondary btn-sm" id="refreshQuote">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn btn-secondary btn-sm" id="challengeBtn" title="Ú†Ø§Ù„Ø´ Ø±ÙˆØ²">
                            <i class="fas fa-flag"></i>
                        </button>
                    </div>
                </div>
                <div class="quote-box" id="quoteBox">
                    <div class="quote-text" id="dailyQuote">
                        "Ù…ÙˆÙÙ‚ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ Ù†ÛŒØ³ØªØŒ Ø´Ú©Ø³Øª Ù…Ø±Ú¯Ø¨Ø§Ø± Ù†ÛŒØ³ØªØ› Ø´Ø¬Ø§Ø¹Øª Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø¯Ù† Ø§Ø³Øª Ú©Ù‡ Ø§Ù‡Ù…ÛŒØª Ø¯Ø§Ø±Ø¯."
                    </div>
                    <div class="quote-author" id="quoteAuthor">- ÙˆÛŒÙ†Ø³ØªÙˆÙ† Ú†Ø±Ú†ÛŒÙ„</div>
                </div>
            </div>

            <!-- ØªØ§ÛŒÙ…Ø± Ù…Ø·Ø§Ù„Ø¹Ù‡ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-clock"></i>
                        ØªØ§ÛŒÙ…Ø± Ù…Ø·Ø§Ù„Ø¹Ù‡
                    </div>
                    <div>
                        <button class="btn btn-secondary btn-sm" id="timerModeBtn" title="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
                
                <div class="timer-mode" id="timerModeDisplay" title="Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯">Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ (25/5)</div>
                <div class="timer-display" id="timerDisplay">25:00</div>
                
                <div class="timer-controls">
                    <button class="btn btn-primary" id="startTimer">
                        <i class="fas fa-play"></i>
                        <span>Ø´Ø±ÙˆØ¹</span>
                    </button>
                    <button class="btn btn-secondary" id="pauseTimer">
                        <i class="fas fa-pause"></i>
                        <span>ØªÙˆÙ‚Ù</span>
                    </button>
                    <button class="btn btn-danger" id="resetTimer">
                        <i class="fas fa-redo"></i>
                        <span>Ø±ÛŒØ³Øª</span>
                    </button>
                </div>

                <div class="timer-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="todayTime">0</div>
                        <div>Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ù…Ø±ÙˆØ²</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="streakDays">0</div>
                        <div>Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="totalSessions">0</div>
                        <div>Ø¬Ù„Ø³Ø§Øª</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="totalHours">0</div>
                        <div>Ø³Ø§Ø¹Øª Ú©Ù„</div>
                    </div>
                </div>
            </div>

            <!-- Ø¯Ø±Ø®Øª Ù¾ÛŒØ´Ø±ÙØª -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-tree"></i>
                        Ø¯Ø±Ø®Øª ØªÙ…Ø±Ú©Ø²
                    </div>
                    <button class="btn btn-secondary btn-sm" id="treeInfoBtn" title="Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø±Ø®Øª">
                        <i class="fas fa-info"></i>
                    </button>
                </div>
                <div class="tree-container">
                    <div class="tree-icon" id="treeIcon" title="Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†">ğŸŒ±</div>
                    <div class="tree-level">Ø³Ø·Ø­ <span id="treeLevel">1</span></div>
                    <div class="progress-container">
                        <div class="progress-bar" id="treeProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-text">Ù¾ÛŒØ´Ø±ÙØª: <span id="treeProgressText">0</span>% - ØªØ¬Ø±Ø¨Ù‡: <span id="treeExperience">0</span>/<span id="treeMaxExperience">100</span></div>
                </div>
            </div>

            <!-- Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-trophy"></i>
                        Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§
                    </div>
                    <span class="stat-number" id="achievementsCount">0/20</span>
                </div>
                <div class="achievements-grid" id="achievementsGrid">
                    <!-- Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>
            </div>

            <!-- Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ -->
            <div class="card" id="dailyChallengeCard" style="display: none;">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-flag"></i>
                        Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡
                    </div>
                    <span class="stat-number" id="challengeReward">+50</span>
                </div>
                <div class="quote-box" id="challengeBox">
                    <div class="quote-text" id="challengeText">Ø§Ù…Ø±ÙˆØ² Û³ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ù†!</div>
                    <div class="progress-container" style="margin: 12px 0;">
                        <div class="progress-bar" id="challengeProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="challengeProgressText">Ù¾ÛŒØ´Ø±ÙØª: 0%</div>
                </div>
            </div>
        </section>

        <!-- ØµÙØ­Ù‡ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ -->
        <section id="library-page" class="page">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-book-open"></i>
                        Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¯Ø±Ø³ÛŒ
                    </div>
                    <button class="btn btn-secondary btn-sm" id="libraryStatsBtn">
                        <i class="fas fa-chart-bar"></i>
                    </button>
                </div>
                
                <div class="tabs">
                    <button class="tab active" data-tab="pdfs">PDF Ù‡Ø§</button>
                    <button class="tab" data-tab="flashcards">ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§</button>
                    <button class="tab" data-tab="notes">ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§</button>
                    <button class="tab" data-tab="spaced">Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯</button>
                </div>

                <div id="pdfs-tab" class="tab-content">
                    <div class="upload-area" id="pdfUploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ PDF Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯</p>
                        <p style="font-size: 12px; margin-top: 8px; opacity: 0.7;">Ø­Ø¯Ø§Ú©Ø«Ø± Ø­Ø¬Ù…: 10 Ù…Ú¯Ø§Ø¨Ø§ÛŒØª</p>
                        <input type="file" id="pdfInput" accept=".pdf" hidden>
                    </div>
                    
                    <div class="file-list" id="pdfList">
                        <!-- PDF Ù‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    </div>
                </div>

                <div id="flashcards-tab" class="tab-content" style="display: none;">
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <button class="btn btn-primary" id="createFlashcardBtn" style="flex: 1;">
                            <i class="fas fa-plus"></i>
                            Ø³Ø§Ø®Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯
                        </button>
                        <button class="btn btn-secondary" id="practiceFlashcardsBtn" title="ØªÙ…Ø±ÛŒÙ† ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§">
                            <i class="fas fa-brain"></i>
                        </button>
                    </div>
                    
                    <div id="flashcardsList">
                        <!-- ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    </div>
                </div>

                <div id="notes-tab" class="tab-content" style="display: none;">
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <button class="btn btn-primary" id="createNoteBtn" style="flex: 1;">
                            <i class="fas fa-plus"></i>
                            Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø¬Ø¯ÛŒØ¯
                        </button>
                        <button class="btn btn-secondary" id="searchNotesBtn" title="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    
                    <div id="notesList">
                        <!-- ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    </div>
                </div>

                <div id="spaced-tab" class="tab-content" style="display: none;">
                    <div class="quote-box">
                        <div class="quote-text">
                            <i class="fas fa-brain" style="color: var(--primary); margin-left: 8px;"></i>
                            Ø³ÛŒØ³ØªÙ… Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ ØªÚ©Ø±Ø§Ø± Ø¨Ø§ ÙØ§ØµÙ„Ù‡
                        </div>
                        <div class="quote-author">Ø±ÙˆØ´ Ø¹Ù„Ù…ÛŒ Ø¨Ø±Ø§ÛŒ Ø­ÙØ¸ Ø¨Ù‡ØªØ±</div>
                    </div>
                    
                    <div class="timer-stats" style="margin-top: 20px;">
                        <div class="stat-item">
                            <div class="stat-number" id="cardsToReview">0</div>
                            <div>Ú©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="cardsLearned">0</div>
                            <div>Ú©Ø§Ø±Øª ÛŒØ§Ø¯ Ú¯Ø±ÙØªÙ‡</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="reviewAccuracy">0%</div>
                            <div>Ø¯Ù‚Øª Ù…Ø±ÙˆØ±</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="nextReview">0</div>
                            <div>Ø³Ø§Ø¹Øª ØªØ§ Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" id="startReviewBtn" style="width: 100%; margin-top: 20px;">
                        <i class="fas fa-play-circle"></i>
                        Ø´Ø±ÙˆØ¹ Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯
                    </button>
                </div>
            </div>
        </section>

        <!-- ØµÙØ­Ù‡ ØªÙ…Ø±Ú©Ø² - ØªÙ…Ø§Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯ -->
        <section id="focus-page" class="page">
            <!-- ÙÙ‚Ø· Ø¨Ø®Ø´ Ø³Ù„Ø§Ù…Øª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-heartbeat"></i>
                        Ø³Ù„Ø§Ù…Øª Ù…Ø·Ø§Ù„Ø¹Ù‡
                    </div>
                    <button class="btn btn-secondary btn-sm" id="healthSettingsBtn">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
                
                <div class="timer-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="eyeRestTimer">20:00</div>
                        <div>Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="stretchTimer">60:00</div>
                        <div>Ú©Ø´Ø´ Ø¨Ø¹Ø¯ÛŒ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="postureScore">100%</div>
                        <div>ÙˆØ¶Ø¹ÛŒØª Ù†Ø´Ø³ØªÙ†</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="hydrationCount">0</div>
                        <div>Ù„ÛŒÙˆØ§Ù† Ø¢Ø¨ Ø§Ù…Ø±ÙˆØ²</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px;">
                    <button class="btn btn-success" id="takeEyeBreakBtn">
                        <i class="fas fa-eye"></i>
                        Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…
                    </button>
                    <button class="btn btn-success" id="takeStretchBreakBtn">
                        <i class="fas fa-running"></i>
                        Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ
                    </button>
                    <button class="btn btn-primary" id="logWaterBtn">
                        <i class="fas fa-tint"></i>
                        Ø«Ø¨Øª Ù†ÙˆØ´ÛŒØ¯Ù† Ø¢Ø¨
                    </button>
                    <button class="btn btn-primary" id="postureCheckBtn">
                        <i class="fas fa-user"></i>
                        Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
                    </button>
                </div>
            </div>
        </section>

        <!-- ØµÙØ­Ù‡ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† -->
        <section id="notifications-page" class="page">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-bell"></i>
                        ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§ Ùˆ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§
                    </div>
                    <div>
                        <button class="btn btn-secondary btn-sm" id="markAllRead">
                            <i class="fas fa-check-double"></i>
                        </button>
                        <button class="btn btn-secondary btn-sm" id="clearNotifications">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                
                <div class="notifications-list" id="notificationsList">
                    <!-- Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§ -->
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-clock"></i>
                        ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ
                    </div>
                </div>
                
                <div class="reminder-settings">
                    <form class="reminder-form" id="reminderForm">
                        <div class="reminder-row">
                            <label style="flex: 1;">ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ ØµØ¨Ø­Ú¯Ø§Ù‡ÛŒ</label>
                            <input type="time" class="reminder-time" id="morningReminder" value="08:00">
                            <label class="switch">
                                <input type="checkbox" id="morningReminderToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="reminder-row">
                            <label style="flex: 1;">ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø¨Ø¹Ø¯Ø§Ø²Ø¸Ù‡Ø±</label>
                            <input type="time" class="reminder-time" id="afternoonReminder" value="14:00">
                            <label class="switch">
                                <input type="checkbox" id="afternoonReminderToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="reminder-row">
                            <label style="flex: 1;">ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø´Ø¨</label>
                            <input type="time" class="reminder-time" id="eveningReminder" value="20:00">
                            <label class="switch">
                                <input type="checkbox" id="eveningReminderToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button type="button" class="btn btn-primary" id="saveReminders">
                            <i class="fas fa-save"></i>
                            Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                        </button>
                    </form>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-cog"></i>
                        ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§
                    </div>
                </div>
                
                <div class="settings-list">
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-volume-up"></i>
                            </div>
                            <div>
                                <div class="setting-name">ØµØ¯Ø§ÛŒ Ø§Ø¹Ù„Ø§Ù†</div>
                                <div class="setting-desc">Ù¾Ø®Ø´ ØµØ¯Ø§ Ù‡Ù†Ú¯Ø§Ù… Ø§Ø¹Ù„Ø§Ù†</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="notificationSoundToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-vibrate"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ù„Ø±Ø²Ø´</div>
                                <div class="setting-desc">Ù„Ø±Ø²Ø´ Ù‡Ù†Ú¯Ø§Ù… Ø§Ø¹Ù„Ø§Ù†</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="notificationVibrationToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div>
                                <div class="setting-name">ÛŒØ§Ø¯Ø¢ÙˆØ± Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…</div>
                                <div class="setting-desc">Ù‡Ø± 20 Ø¯Ù‚ÛŒÙ‚Ù‡</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="eyeBreakToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <div>
                                <div class="setting-name">ÛŒØ§Ø¯Ø¢ÙˆØ± Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ</div>
                                <div class="setting-desc">Ù‡Ø± 60 Ø¯Ù‚ÛŒÙ‚Ù‡</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="stretchBreakToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </section>

        <!-- ØµÙØ­Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª -->
        <section id="settings-page" class="page">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-user"></i>
                        Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±ÛŒ
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="userName">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                    <input type="text" id="userName" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                
                <div class="form-group">
                    <label for="userEmail">Ø§ÛŒÙ…ÛŒÙ„ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
                    <input type="email" id="userEmail" placeholder="email@example.com">
                </div>
                
                <div class="form-group">
                    <label for="dailyGoal">Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡ (Ø¯Ù‚ÛŒÙ‚Ù‡)</label>
                    <input type="number" id="dailyGoal" min="15" max="600" value="120">
                </div>
                
                <button class="btn btn-primary" id="saveProfileBtn" style="width: 100%;">
                    <i class="fas fa-save"></i>
                    Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª
                </button>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-palette"></i>
                        ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¸Ø§Ù‡Ø±ÛŒ
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù†ØªØ®Ø§Ø¨ ØªÙ…</label>
                    <div class="theme-selector">
                        <div class="theme-option active" data-theme="default">
                            <div class="theme-check">
                                <i class="fas fa-check"></i>
                            </div>
                        </div>
                        <div class="theme-option" data-theme="nature"></div>
                        <div class="theme-option" data-theme="energy"></div>
                        <div class="theme-option" data-theme="professional"></div>
                        <div class="theme-option" data-theme="calm"></div>
                    </div>
                </div>
                
                <div class="settings-list">
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©</div>
                                <div class="setting-desc">ØªÙ… ØªÛŒØ±Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="darkModeSwitch">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-font"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª Ø¨Ø²Ø±Ú¯</div>
                                <div class="setting-desc">Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ Ø¨Ù‡ØªØ±</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="largeFontToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-animation"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§</div>
                                <div class="setting-desc">Ø§ÙÚ©Øªâ€ŒÙ‡Ø§ÛŒ Ø¨ØµØ±ÛŒ</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="animationsToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-clock"></i>
                        ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÙ…Ø±
                    </div>
                </div>
                
                <div class="settings-list">
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-volume-up"></i>
                            </div>
                            <div>
                                <div class="setting-name">ØµØ¯Ø§ÛŒ Ù¾Ø§ÛŒØ§Ù† ØªØ§ÛŒÙ…Ø±</div>
                                <div class="setting-desc">Ù¾Ø®Ø´ ØµØ¯Ø§ Ù‡Ù†Ú¯Ø§Ù… Ù¾Ø§ÛŒØ§Ù†</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="timerSoundToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ø§Ø¹Ù„Ø§Ù† Ù¾Ø§ÛŒØ§Ù† ØªØ§ÛŒÙ…Ø±</div>
                                <div class="setting-desc">Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ù‡Ù†Ú¯Ø§Ù… Ù¾Ø§ÛŒØ§Ù†</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="timerNotificationToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 16px;">
                    <label for="autoStartBreak">Ø´Ø±ÙˆØ¹ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø³ØªØ±Ø§Ø­Øª</label>
                    <select id="autoStartBreak" class="form-control">
                        <option value="0">Ø®Ø§Ù…ÙˆØ´</option>
                        <option value="5">Ù¾Ø³ Ø§Ø² 5 Ø«Ø§Ù†ÛŒÙ‡</option>
                        <option value="10">Ù¾Ø³ Ø§Ø² 10 Ø«Ø§Ù†ÛŒÙ‡</option>
                        <option value="30">Ù¾Ø³ Ø§Ø² 30 Ø«Ø§Ù†ÛŒÙ‡</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-cloud"></i>
                        Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                    </div>
                </div>
                
                <div class="settings-list">
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</div>
                                <div class="setting-desc">Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± ÙØ¶Ø§ÛŒ Ø§Ø¨Ø±ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="autoSync" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div>
                                <div class="setting-name">Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</div>
                                <div class="setting-desc">Ø­ÙØ¸ Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ</div>
                            </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="encryptionToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px;">
                    <button class="btn btn-secondary" id="backupBtn">
                        <i class="fas fa-download"></i>
                        Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                    </button>
                    <button class="btn btn-secondary" id="restoreBtn">
                        <i class="fas fa-upload"></i>
                        Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-database"></i>
                        Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <button class="btn btn-secondary" id="exportDataBtn">
                        <i class="fas fa-file-export"></i>
                        Ø®Ø±ÙˆØ¬ÛŒ
                    </button>
                    <button class="btn btn-danger" id="resetDataBtn">
                        <i class="fas fa-trash"></i>
                        Ø±ÛŒØ³Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    </button>
                </div>
                
                <div style="margin-top: 16px; padding: 12px; background: rgba(0,0,0,0.02); border-radius: 8px;">
                    <div style="font-size: 12px; opacity: 0.7; margin-bottom: 4px;">ÙØ¶Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:</div>
                    <div class="progress-container" style="height: 6px;">
                        <div class="progress-bar" id="storageUsage" style="width: 0%"></div>
                    </div>
                    <div style="font-size: 11px; text-align: center; margin-top: 4px;">
                        <span id="storageUsed">0</span> Ø§Ø² <span id="storageTotal">5</span> Ù…Ú¯Ø§Ø¨Ø§ÛŒØª
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Ø¢Ù…Ø§Ø± Ùˆ Ø¢Ù†Ø§Ù„ÛŒØ²
                    </div>
                </div>
                
                <div style="text-align: center; padding: 20px 0;">
                    <div class="timer-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="avgStudyTime">0</div>
                            <div>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø±ÙˆØ²Ø§Ù†Ù‡</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="bestDay">0</div>
                            <div>Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ²</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="focusScore">0%</div>
                            <div>Ø§Ù…ØªÛŒØ§Ø² ØªÙ…Ø±Ú©Ø²</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="consistency">0%</div>
                            <div>ØªØ¯Ø§ÙˆÙ…</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary" id="viewDetailedStats" style="width: 100%; margin-top: 16px;">
                        <i class="fas fa-chart-bar"></i>
                        Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¢Ù…Ø§Ø± Ú©Ø§Ù…Ù„
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-info-circle"></i>
                        Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡
                    </div>
                </div>
                
                <div style="text-align: center; padding: 20px 0;">
                    <div style="font-size: 14px; margin-bottom: 16px; opacity: 0.8;">
                        Ù†Ø³Ø®Ù‡: 3.0.0
                    </div>
                    <div style="font-size: 16px; font-weight: 600; color: var(--primary); margin-bottom: 8px;">
                        Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø·:
                    </div>
                    <div style="font-size: 18px; font-weight: 700; background: linear-gradient(135deg, var(--primary), var(--primary-light)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø´Ø±Ú©Ø§Ø¦ÛŒ
                    </div>
                    <div style="font-size: 14px; margin-top: 8px; opacity: 0.7;">
                        Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ù…Ø¯Ø±Ø³Ù‡ Ù…Ù‡Ø± Ø¢ÙØ±ÛŒÙ†Ø§Ù†
                    </div>
                    <div style="margin-top: 20px; font-size: 12px; opacity: 0.5;">
                        ØªÙ…Ø§Ù… Ø­Ù‚ÙˆÙ‚ Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª Â© 2024
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Ù…ÙˆØ¯Ø§Ù„ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª -->
    <div class="modal" id="flashcardModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯</div>
                <button class="modal-close" id="closeFlashcardModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="flashcardQuestion">Ø³ÙˆØ§Ù„</label>
                    <textarea id="flashcardQuestion" rows="3" placeholder="Ø³ÙˆØ§Ù„ ÛŒØ§ Ø¹Ù†ÙˆØ§Ù†..."></textarea>
                </div>
                <div class="form-group">
                    <label for="flashcardAnswer">Ù¾Ø§Ø³Ø®</label>
                    <textarea id="flashcardAnswer" rows="3" placeholder="Ù¾Ø§Ø³Ø® ÛŒØ§ ØªÙˆØ¶ÛŒØ­..."></textarea>
                </div>
                <div class="form-group">
                    <label for="flashcardCategory">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
                    <input type="text" id="flashcardCategory" placeholder="Ù…Ø«Ù„: Ø±ÛŒØ§Ø¶ÛŒØŒ ÙÛŒØ²ÛŒÚ©ØŒ ...">
                </div>
                <div class="form-group">
                    <label for="flashcardDifficulty">Ø³Ø·Ø­ Ø¯Ø´ÙˆØ§Ø±ÛŒ</label>
                    <select id="flashcardDifficulty" class="form-control">
                        <option value="easy">Ø¢Ø³Ø§Ù†</option>
                        <option value="medium">Ù…ØªÙˆØ³Ø·</option>
                        <option value="hard">Ø³Ø®Øª</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="saveFlashcardBtn" style="width: 100%;">
                    <i class="fas fa-save"></i>
                    Ø°Ø®ÛŒØ±Ù‡ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª
                </button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª -->
    <div class="modal" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø¬Ø¯ÛŒØ¯</div>
                <button class="modal-close" id="closeNoteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="noteTitle">Ø¹Ù†ÙˆØ§Ù†</label>
                    <input type="text" id="noteTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† ÛŒØ§Ø¯Ø¯Ø§Ø´Øª...">
                </div>
                <div class="form-group">
                    <label for="noteContent">Ù…Ø­ØªÙˆØ§</label>
                    <textarea id="noteContent" rows="5" placeholder="Ù…ØªÙ† ÛŒØ§Ø¯Ø¯Ø§Ø´Øª..."></textarea>
                </div>
                <div class="form-group">
                    <label for="noteCategory">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
                    <input type="text" id="noteCategory" placeholder="Ù…Ø«Ù„: Ø®Ù„Ø§ØµÙ‡ Ø¯Ø±Ø³ØŒ Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…...">
                </div>
                <button class="btn btn-primary" id="saveNoteBtn" style="width: 100%;">
                    <i class="fas fa-save"></i>
                    Ø°Ø®ÛŒØ±Ù‡ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª
                </button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ -->
    <div class="modal" id="backupModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</div>
                <button class="modal-close" id="closeBackupModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø´Ù…Ø§:</p>
                <textarea id="backupDataText" rows="5" style="width: 100%; margin: 12px 0; padding: 12px; border-radius: 8px; background: rgba(0,0,0,0.05); border: none;" readonly></textarea>
                <button class="btn btn-primary" id="copyBackupBtn" style="width: 100%; margin-bottom: 8px;">
                    <i class="fas fa-copy"></i>
                    Ú©Ù¾ÛŒ Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
                </button>
                <button class="btn btn-secondary" id="downloadBackupBtn" style="width: 100%;">
                    <i class="fas fa-download"></i>
                    Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
                </button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ -->
    <div class="modal" id="restoreModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</div>
                <button class="modal-close" id="closeRestoreModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†</label>
                    <input type="file" id="restoreFileInput" accept=".json,.txt" style="width: 100%; padding: 8px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px;">
                </div>
                <div style="text-align: center; margin: 16px 0; opacity: 0.7;">ÛŒØ§</div>
                <div class="form-group">
                    <label>Ú†Ø³Ø¨Ø§Ù†Ø¯Ù† Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†</label>
                    <textarea id="restoreDataText" rows="5" placeholder="Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ú†Ø³Ø¨Ø§Ù†ÛŒØ¯..." style="width: 100%; padding: 12px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px;"></textarea>
                </div>
                <button class="btn btn-primary" id="confirmRestoreBtn" style="width: 100%;">
                    <i class="fas fa-upload"></i>
                    Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                </button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ ØªØ§ÛŒÙ…Ø± -->
    <div class="modal" id="timerModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÙ…Ø±</div>
                <button class="modal-close" id="closeTimerModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Ø§Ù†ØªØ®Ø§Ø¨ Ø­Ø§Ù„Øª Ù…Ø·Ø§Ù„Ø¹Ù‡</label>
                    <div class="settings-list" style="margin-top: 12px;">
                        <div class="setting-item timer-mode-option active" data-mode="pomodoro">
                            <div class="setting-info">
                                <div class="setting-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div>
                                    <div class="setting-name">Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ</div>
                                    <div class="setting-desc">25 Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ / 5 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø³ØªØ±Ø§Ø­Øª</div>
                                </div>
                            </div>
                            <div class="theme-check">
                                <i class="fas fa-check"></i>
                            </div>
                        </div>
                        <div class="setting-item timer-mode-option" data-mode="deep">
                            <div class="setting-info">
                                <div class="setting-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div>
                                    <div class="setting-name">Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¹Ù…ÛŒÙ‚</div>
                                    <div class="setting-desc">50 Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ / 10 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø³ØªØ±Ø§Ø­Øª</div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item timer-mode-option" data-mode="sprint">
                            <div class="setting-info">
                                <div class="setting-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div>
                                    <div class="setting-name">Ø§Ø³Ù¾Ø±ÛŒÙ†Øª</div>
                                    <div class="setting-desc">15 Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ / 3 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø³ØªØ±Ø§Ø­Øª</div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item timer-mode-option" data-mode="marathon">
                            <div class="setting-info">
                                <div class="setting-icon">
                                    <i class="fas fa-running"></i>
                                </div>
                                <div>
                                    <div class="setting-name">Ù…Ø§Ø±Ø§ØªÙ†</div>
                                    <div class="setting-desc">90 Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ / 20 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø³ØªØ±Ø§Ø­Øª</div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item timer-mode-option" data-mode="custom">
                            <div class="setting-info">
                                <div class="setting-icon">
                                    <i class="fas fa-cog"></i>
                                </div>
                                <div>
                                    <div class="setting-name">Ø³ÙØ§Ø±Ø´ÛŒ</div>
                                    <div class="setting-desc">Ø²Ù…Ø§Ù† Ø¯Ù„Ø®ÙˆØ§Ù‡</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="customTimerSettings" style="display: none; margin-top: 20px; padding: 16px; background: rgba(0,0,0,0.02); border-radius: 8px;">
                    <div class="form-group">
                        <label for="customFocusTime">Ø²Ù…Ø§Ù† Ù…Ø·Ø§Ù„Ø¹Ù‡ (Ø¯Ù‚ÛŒÙ‚Ù‡)</label>
                        <input type="number" id="customFocusTime" min="5" max="180" value="25" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="customBreakTime">Ø²Ù…Ø§Ù† Ø§Ø³ØªØ±Ø§Ø­Øª (Ø¯Ù‚ÛŒÙ‚Ù‡)</label>
                        <input type="number" id="customBreakTime" min="1" max="30" value="5" class="form-control">
                    </div>
                </div>
                
                <button class="btn btn-primary" id="saveTimerSettings" style="width: 100%; margin-top: 20px;">
                    <i class="fas fa-save"></i>
                    Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                </button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ù…Ø±ÙˆØ± ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª -->
    <div class="modal" id="reviewModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯</div>
                <button class="modal-close" id="closeReviewModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px 0;">
                    <div id="reviewQuestion" style="font-size: 18px; margin-bottom: 30px; min-height: 100px; display: flex; align-items: center; justify-content: center; padding: 20px; background: rgba(0,0,0,0.02); border-radius: 12px;">
                        Ø³ÙˆØ§Ù„ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯...
                    </div>
                    
                    <div id="reviewAnswer" style="display: none; font-size: 16px; margin-bottom: 30px; min-height: 100px; padding: 20px; background: rgba(106, 17, 203, 0.05); border-radius: 12px; border-right: 3px solid var(--primary);">
                        Ù¾Ø§Ø³Ø® Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯...
                    </div>
                    
                    <div id="reviewControls" style="display: none;">
                        <div style="font-size: 14px; margin-bottom: 16px; opacity: 0.7;">Ú†Ù‚Ø¯Ø± Ø®ÙˆØ¨ ÛŒØ§Ø¯Øª Ø¨ÙˆØ¯ØŸ</div>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                            <button class="btn btn-danger" data-rating="again">
                                <i class="fas fa-times"></i>
                                ÛŒØ§Ø¯Ù… Ù†ÛŒØ³Øª
                            </button>
                            <button class="btn btn-warning" data-rating="hard">
                                <i class="fas fa-hard-hat"></i>
                                Ø³Ø®Øª Ø¨ÙˆØ¯
                            </button>
                            <button class="btn btn-primary" data-rating="good">
                                <i class="fas fa-check"></i>
                                Ø®ÙˆØ¨ Ø¨ÙˆØ¯
                            </button>
                            <button class="btn btn-success" data-rating="easy">
                                <i class="fas fa-star"></i>
                                Ø¢Ø³Ø§Ù† Ø¨ÙˆØ¯
                            </button>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" id="showAnswerBtn" style="width: 100%; margin-top: 20px;">
                        <i class="fas fa-eye"></i>
                        Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ø³Ø®
                    </button>
                    
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(0,0,0,0.1);">
                        <div class="timer-stats" style="grid-template-columns: repeat(2, 1fr);">
                            <div class="stat-item">
                                <div class="stat-number" id="reviewProgress">0</div>
                                <div>Ú©Ø§Ø±Øª Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="reviewCorrect">0</div>
                                <div>Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ØªÙˆØ³Øª -->
    <div class="notification-toast" id="notificationToast">
        <div class="notification-icon">
            <i class="fas fa-check"></i>
        </div>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">Ù…ÙˆÙÙ‚ÛŒØª</div>
            <div class="notification-message" id="notificationMessage">Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</div>
        </div>
    </div>

    <!-- Ù„ÙˆØ¯Ø± -->
    <div class="modal" id="loadingModal">
        <div class="modal-content" style="max-width: 200px; text-align: center;">
            <div class="loader"></div>
            <p style="margin-top: 12px;" id="loadingText">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</p>
        </div>
    </div>

    <script>
        // ============================================
        // Ú©Ù„Ø§Ø³ Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡ (Ø¨Ø¯ÙˆÙ† Ø¨Ø®Ø´ ØµØ¯Ø§)
        // ============================================
        class MStudyPro {
            constructor() {
                this.userData = null;
                this.timer = null;
                this.timerInterval = null;
                this.isDarkMode = false;
                this.currentTheme = 'default';
                this.currentPage = 'dashboard';
                this.notifications = [];
                this.quotes = [];
                this.challenges = [];
                this.activeSounds = []; // Ø­Ø°Ù Ú©Ø§Ù…Ù„ ØµØ¯Ø§
                this.storage = new EnhancedStorage(this);
                this.reviewManager = new ReviewManager(this);
                this.challengeManager = new ChallengeManager(this);
                this.healthManager = new HealthManager(this);
                this.statsManager = new StatsManager(this);
                
                this.initializeApp();
            }
            
            async initializeApp() {
                this.showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ...');
                
                await this.loadUserData();
                this.setupEventListeners();
                this.initializeTimer();
                this.loadQuotes();
                this.loadChallenges();
                this.setupTheme();
                this.checkPermissions();
                this.setupNotifications();
                this.reviewManager.initialize();
                this.challengeManager.initialize();
                this.healthManager.initialize();
                this.statsManager.initialize();
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø§ÙˆÙ„ÛŒÙ‡
                this.storage.initialSave();
                
                // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ø§Ø³Ù¾Ù„Ø´ Ø¨Ø¹Ø¯ Ø§Ø² 2 Ø«Ø§Ù†ÛŒÙ‡
                setTimeout(() => {
                    this.hideSplashScreen();
                    this.hideLoading();
                    this.showWelcomeNotification();
                }, 2000);
                
                // Ø´Ø±ÙˆØ¹ Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯
                this.startMonitoring();
            }
            
            hideSplashScreen() {
                const splash = document.getElementById('splash-screen');
                splash.classList.add('hidden');
                
                setTimeout(() => {
                    splash.style.display = 'none';
                }, 500);
            }
            
            showWelcomeNotification() {
                const name = this.userData.name || 'Ú©Ø§Ø±Ø¨Ø±';
                const today = new Date().toLocaleDateString('fa-IR');
                this.showNotification('Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!', `Ø³Ù„Ø§Ù… ${name}! Ø§Ù…Ø±ÙˆØ² ${today} Ù‡Ø³Øª. Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´ÛŒØ¯!`);
                
                // Ù†Ù…Ø§ÛŒØ´ Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡
                this.challengeManager.showDailyChallenge();
            }
            
            async loadUserData() {
                try {
                    const saved = await this.storage.load();
                    if (saved) {
                        this.userData = saved;
                        this.currentTheme = this.userData.settings?.theme || 'default';
                        this.isDarkMode = this.userData.settings?.darkMode || false;
                    } else {
                        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
                        this.userData = this.getDefaultUserData();
                    }
                    
                    this.updateUI();
                    this.storage.updateStorageInfo();
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', error);
                    this.userData = this.getDefaultUserData();
                    this.showNotification('Ø®Ø·Ø§', 'Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯. Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.');
                }
            }
            
            getDefaultUserData() {
                const now = new Date();
                return {
                    name: '',
                    email: '',
                    dailyGoal: 120,
                    stats: {
                        totalStudyTime: 0,
                        todayStudyTime: 0,
                        streakDays: 0,
                        lastStudyDate: null,
                        totalSessions: 0,
                        totalHours: 0,
                        bestDay: 0,
                        studyDays: {},
                        focusScore: 0,
                        consistency: 0
                    },
                    tree: {
                        level: 1,
                        experience: 0,
                        maxExperience: 100,
                        lastWaterTime: null,
                        waterCount: 0,
                        postureScore: 100,
                        lastPostureCheck: null
                    },
                    achievements: [],
                    pdfs: [],
                    flashcards: [],
                    notes: [],
                    notifications: [],
                    reminders: {
                        morning: { enabled: true, time: '08:00' },
                        afternoon: { enabled: true, time: '14:00' },
                        evening: { enabled: true, time: '20:00' }
                    },
                    settings: {
                        theme: 'default',
                        darkMode: false,
                        autoSync: true,
                        soundsEnabled: true,
                        notificationsEnabled: true,
                        notificationSound: true,
                        notificationVibration: true,
                        largeFont: false,
                        animations: true,
                        timerSound: true,
                        timerNotification: true,
                        autoStartBreak: 0,
                        encryption: true,
                        eyeBreak: true,
                        stretchBreak: true
                    },
                    timerModes: {
                        current: 'pomodoro',
                        pomodoro: { focus: 25, break: 5 },
                        deep: { focus: 50, break: 10 },
                        sprint: { focus: 15, break: 3 },
                        marathon: { focus: 90, break: 20 },
                        custom: { focus: 25, break: 5 }
                    },
                    challenges: {
                        daily: null,
                        completed: [],
                        streak: 0,
                        lastCompleted: null
                    },
                    reviews: {
                        cards: [],
                        nextReview: null,
                        stats: {
                            totalReviews: 0,
                            correctReviews: 0,
                            lastReviewDate: null
                        }
                    },
                    health: {
                        lastEyeBreak: null,
                        lastStretchBreak: null,
                        waterLog: [],
                        postureChecks: []
                    },
                    version: '3.0.0',
                    lastSync: new Date().toISOString(),
                    createdAt: new Date().toISOString()
                };
            }
            
            async saveUserData() {
                try {
                    this.userData.lastSync = new Date().toISOString();
                    await this.storage.save(this.userData);
                    
                    if (this.userData.settings.autoSync) {
                        this.syncData();
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', error);
                    this.showNotification('Ø®Ø·Ø§', 'Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.');
                }
            }
            
            async syncData() {
                try {
                    await this.storage.syncToCloud();
                    this.showNotification('Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.');
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ:', error);
                }
            }
            
            setupEventListeners() {
                // Ù†Ø§ÙˆØ¨Ø±ÛŒ
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showPage(item.dataset.page);
                        
                        document.querySelectorAll('.nav-item').forEach(nav => {
                            nav.classList.remove('active');
                        });
                        item.classList.add('active');
                    });
                });
                
                // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡Ø¯Ø±
                document.getElementById('themeToggle').addEventListener('click', () => this.toggleDarkMode());
                document.getElementById('syncBtn').addEventListener('click', () => this.syncData());
                document.getElementById('notificationBtn').addEventListener('click', () => {
                    this.showPage('notifications');
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                        if (nav.dataset.page === 'notifications') {
                            nav.classList.add('active');
                        }
                    });
                });
                
                // ØªØ§ÛŒÙ…Ø±
                document.getElementById('startTimer').addEventListener('click', () => this.startTimer());
                document.getElementById('pauseTimer').addEventListener('click', () => this.pauseTimer());
                document.getElementById('resetTimer').addEventListener('click', () => this.resetTimer());
                document.getElementById('timerModeBtn').addEventListener('click', () => this.showTimerModal());
                document.getElementById('timerModeDisplay').addEventListener('click', () => this.cycleTimerMode());
                
                // Ø¬Ù…Ù„Ø§Øª Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ Ùˆ Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§
                document.getElementById('refreshQuote').addEventListener('click', () => this.showRandomQuote());
                document.getElementById('challengeBtn').addEventListener('click', () => this.toggleChallenge());
                document.getElementById('quoteBox').addEventListener('click', () => this.showRandomQuote());
                
                // Ø¯Ø±Ø®Øª
                document.getElementById('treeIcon').addEventListener('click', () => this.animateTree());
                document.getElementById('treeInfoBtn').addEventListener('click', () => this.showTreeInfo());
                
                // ØªÙ…
                document.getElementById('darkModeSwitch').addEventListener('change', (e) => {
                    this.toggleDarkMode(e.target.checked);
                });
                
                // Ø§Ù†ØªØ®Ø§Ø¨ ØªÙ…
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.addEventListener('click', () => {
                        this.changeTheme(option.dataset.theme);
                    });
                });
                
                // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ
                document.getElementById('autoSync').addEventListener('change', (e) => {
                    this.userData.settings.autoSync = e.target.checked;
                    this.saveUserData();
                });
                
                // Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ
                document.getElementById('encryptionToggle').addEventListener('change', (e) => {
                    this.userData.settings.encryption = e.target.checked;
                    this.saveUserData();
                });
                
                // Ù¾Ø±ÙˆÙØ§ÛŒÙ„
                document.getElementById('saveProfileBtn').addEventListener('click', () => this.saveProfile());
                document.getElementById('dailyGoal').addEventListener('change', (e) => {
                    this.userData.dailyGoal = parseInt(e.target.value);
                    this.saveUserData();
                });
                
                // PDF Ø¢Ù¾Ù„ÙˆØ¯
                document.getElementById('pdfUploadArea').addEventListener('click', () => {
                    document.getElementById('pdfInput').click();
                });
                
                document.getElementById('pdfUploadArea').addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.currentTarget.style.borderColor = 'var(--primary)';
                    e.currentTarget.style.background = 'rgba(106, 17, 203, 0.05)';
                });
                
                document.getElementById('pdfUploadArea').addEventListener('dragleave', (e) => {
                    e.currentTarget.style.borderColor = 'rgba(106, 17, 203, 0.3)';
                    e.currentTarget.style.background = 'transparent';
                });
                
                document.getElementById('pdfUploadArea').addEventListener('drop', (e) => {
                    e.preventDefault();
                    e.currentTarget.style.borderColor = 'rgba(106, 17, 203, 0.3)';
                    e.currentTarget.style.background = 'transparent';
                    
                    if (e.dataTransfer.files.length > 0) {
                        this.uploadPDF(e.dataTransfer.files[0]);
                    }
                });
                
                document.getElementById('pdfInput').addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.uploadPDF(e.target.files[0]);
                    }
                });
                
                // ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª
                document.getElementById('createFlashcardBtn').addEventListener('click', () => {
                    this.showModal('flashcardModal');
                });
                
                document.getElementById('saveFlashcardBtn').addEventListener('click', () => {
                    this.saveFlashcard();
                });
                
                document.getElementById('closeFlashcardModal').addEventListener('click', () => {
                    this.hideModal('flashcardModal');
                });
                
                document.getElementById('practiceFlashcardsBtn').addEventListener('click', () => {
                    this.startFlashcardPractice();
                });
                
                // ÛŒØ§Ø¯Ø¯Ø§Ø´Øª
                document.getElementById('createNoteBtn').addEventListener('click', () => {
                    this.showModal('noteModal');
                });
                
                document.getElementById('saveNoteBtn').addEventListener('click', () => {
                    this.saveNote();
                });
                
                document.getElementById('closeNoteModal').addEventListener('click', () => {
                    this.hideModal('noteModal');
                });
                
                document.getElementById('searchNotesBtn').addEventListener('click', () => {
                    this.searchNotes();
                });
                
                // Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯
                document.getElementById('startReviewBtn').addEventListener('click', () => {
                    this.startSmartReview();
                });
                
                // Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                document.getElementById('backupBtn').addEventListener('click', () => {
                    this.showBackupModal();
                });
                
                document.getElementById('copyBackupBtn').addEventListener('click', () => {
                    this.copyBackup();
                });
                
                document.getElementById('downloadBackupBtn').addEventListener('click', () => {
                    this.downloadBackup();
                });
                
                document.getElementById('closeBackupModal').addEventListener('click', () => {
                    this.hideModal('backupModal');
                });
                
                // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
                document.getElementById('restoreBtn').addEventListener('click', () => {
                    this.showModal('restoreModal');
                });
                
                document.getElementById('confirmRestoreBtn').addEventListener('click', () => {
                    this.restoreData();
                });
                
                document.getElementById('closeRestoreModal').addEventListener('click', () => {
                    this.hideModal('restoreModal');
                });
                
                // Ø±ÛŒØ³Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                document.getElementById('resetDataBtn').addEventListener('click', () => {
                    this.resetUserData();
                });
                
                // Ø®Ø±ÙˆØ¬ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                document.getElementById('exportDataBtn').addEventListener('click', () => {
                    this.exportData();
                });
                
                // ØªØ¨â€ŒÙ‡Ø§
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.dataset.tab;
                        this.showTab(tabId);
                    });
                });
                
                // ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§
                document.getElementById('saveReminders').addEventListener('click', () => {
                    this.saveReminders();
                });
                
                document.getElementById('markAllRead').addEventListener('click', () => {
                    this.markAllNotificationsAsRead();
                });
                
                document.getElementById('clearNotifications').addEventListener('click', () => {
                    this.clearNotifications();
                });
                
                // ØµØ¯Ø§Ù‡Ø§ â€“ ØªÙ…Ø§Ù… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
                
                // Ø³Ù„Ø§Ù…Øª
                document.getElementById('takeEyeBreakBtn').addEventListener('click', () => {
                    this.healthManager.takeEyeBreak();
                });
                
                document.getElementById('takeStretchBreakBtn').addEventListener('click', () => {
                    this.healthManager.takeStretchBreak();
                });
                
                document.getElementById('logWaterBtn').addEventListener('click', () => {
                    this.healthManager.logWater();
                });
                
                document.getElementById('postureCheckBtn').addEventListener('click', () => {
                    this.healthManager.checkPosture();
                });
                
                document.getElementById('eyeBreakToggle').addEventListener('change', (e) => {
                    this.userData.settings.eyeBreak = e.target.checked;
                    this.saveUserData();
                });
                
                document.getElementById('stretchBreakToggle').addEventListener('change', (e) => {
                    this.userData.settings.stretchBreak = e.target.checked;
                    this.saveUserData();
                });
                
                // ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÙ…Ø±
                document.getElementById('timerSoundToggle').addEventListener('change', (e) => {
                    this.userData.settings.timerSound = e.target.checked;
                    this.saveUserData();
                });
                
                document.getElementById('timerNotificationToggle').addEventListener('change', (e) => {
                    this.userData.settings.timerNotification = e.target.checked;
                    this.saveUserData();
                });
                
                document.getElementById('autoStartBreak').addEventListener('change', (e) => {
                    this.userData.settings.autoStartBreak = parseInt(e.target.value);
                    this.saveUserData();
                });
                
                // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§
                document.getElementById('notificationSoundToggle').addEventListener('change', (e) => {
                    this.userData.settings.notificationSound = e.target.checked;
                    this.saveUserData();
                });
                
                document.getElementById('notificationVibrationToggle').addEventListener('change', (e) => {
                    this.userData.settings.notificationVibration = e.target.checked;
                    this.saveUserData();
                });
                
                document.getElementById('largeFontToggle').addEventListener('change', (e) => {
                    this.userData.settings.largeFont = e.target.checked;
                    this.toggleLargeFont(e.target.checked);
                    this.saveUserData();
                });
                
                document.getElementById('animationsToggle').addEventListener('change', (e) => {
                    this.userData.settings.animations = e.target.checked;
                    this.saveUserData();
                });
                
                // Ø¢Ù…Ø§Ø±
                document.getElementById('viewDetailedStats').addEventListener('click', () => {
                    this.showDetailedStats();
                });
                
                document.getElementById('libraryStatsBtn').addEventListener('click', () => {
                    this.showLibraryStats();
                });
                
                // Ù…ÙˆØ¯Ø§Ù„ ØªØ§ÛŒÙ…Ø±
                document.querySelectorAll('.timer-mode-option').forEach(option => {
                    option.addEventListener('click', () => {
                        this.selectTimerMode(option.dataset.mode);
                    });
                });
                
                document.getElementById('saveTimerSettings').addEventListener('click', () => {
                    this.saveTimerSettings();
                });
                
                document.getElementById('closeTimerModal').addEventListener('click', () => {
                    this.hideModal('timerModal');
                });
                
                // Ù…ÙˆØ¯Ø§Ù„ Ù…Ø±ÙˆØ±
                document.getElementById('closeReviewModal').addEventListener('click', () => {
                    this.hideModal('reviewModal');
                });
                
                document.getElementById('showAnswerBtn').addEventListener('click', () => {
                    this.showReviewAnswer();
                });
                
                document.querySelectorAll('[data-rating]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const rating = e.currentTarget.dataset.rating;
                        this.rateReviewCard(rating);
                    });
                });
                
                // Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ù…ÛŒØ§Ù†Ø¨Ø±
                document.addEventListener('keydown', (e) => {
                    // Space Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹/ØªÙˆÙ‚Ù ØªØ§ÛŒÙ…Ø±
                    if (e.code === 'Space' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                        e.preventDefault();
                        if (this.timer && this.timer.isRunning) {
                            this.pauseTimer();
                        } else {
                            this.startTimer();
                        }
                    }
                    
                    // Ctrl+S Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡
                    if (e.ctrlKey && e.key === 's') {
                        e.preventDefault();
                        this.saveUserData();
                        this.showNotification('Ø°Ø®ÛŒØ±Ù‡', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.');
                    }
                    
                    // Ctrl+B Ø¨Ø±Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                    if (e.ctrlKey && e.key === 'b') {
                        e.preventDefault();
                        this.showBackupModal();
                    }
                    
                    // Esc Ø¨Ø±Ø§ÛŒ Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„
                    if (e.key === 'Escape') {
                        this.closeAllModals();
                    }
                    
                    // Ø¹Ø¯Ø¯ 1-5 Ø¨Ø±Ø§ÛŒ Ø±ØªØ¨Ù‡â€ŒØ¯Ù‡ÛŒ Ø¯Ø± Ù…Ø±ÙˆØ±
                    if (e.key >= '1' && e.key <= '4' && document.getElementById('reviewModal').classList.contains('active')) {
                        const ratings = ['again', 'hard', 'good', 'easy'];
                        this.rateReviewCard(ratings[parseInt(e.key) - 1]);
                    }
                });
                
                // Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ø¢Ù†Ù„Ø§ÛŒÙ†/Ø¢ÙÙ„Ø§ÛŒÙ†
                window.addEventListener('online', () => {
                    this.showNotification('Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª', 'Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯.');
                    this.syncData();
                });
                
                window.addEventListener('offline', () => {
                    this.showNotification('Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª', 'Ø´Ù…Ø§ Ø¢ÙÙ„Ø§ÛŒÙ† Ù‡Ø³ØªÛŒØ¯.');
                });
                
                // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ø´ÛŒØ¯Ù† Ø¨Ø±Ø§ÛŒ refresh
                let touchStartY = 0;
                document.addEventListener('touchstart', e => {
                    touchStartY = e.touches[0].clientY;
                }, { passive: true });
                
                document.addEventListener('touchmove', e => {
                    const touchY = e.touches[0].clientY;
                    const diff = touchY - touchStartY;
                    
                    if (diff > 50 && window.scrollY === 0) {
                        e.preventDefault();
                    }
                }, { passive: false });
                
                // Ø±ÙˆÛŒØ¯Ø§Ø¯ visibility change
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        this.storage.emergencySave();
                    } else {
                        this.checkTimersAfterBackground();
                    }
                });
            }
            
            initializeTimer() {
                const currentMode = this.userData.timerModes.current;
                const mode = this.userData.timerModes[currentMode];
                
                this.timer = {
                    minutes: mode.focus,
                    seconds: 0,
                    isRunning: false,
                    mode: 'focus',
                    totalSeconds: mode.focus * 60,
                    focusTime: mode.focus,
                    breakTime: mode.break,
                    startTime: null,
                    endTime: null
                };
                
                this.updateTimerDisplay();
                this.updateTimerModeDisplay();
            }
            
            startTimer() {
                if (this.timer.isRunning) return;
                
                this.timer.isRunning = true;
                this.timer.startTime = Date.now();
                this.timer.endTime = this.timer.startTime + (this.timer.totalSeconds * 1000);
                
                this.timerInterval = setInterval(() => {
                    const now = Date.now();
                    const remaining = Math.max(0, this.timer.endTime - now);
                    
                    this.timer.totalSeconds = Math.ceil(remaining / 1000);
                    
                    if (this.timer.totalSeconds <= 0) {
                        this.timerComplete();
                        return;
                    }
                    
                    this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                    this.timer.seconds = this.timer.totalSeconds % 60;
                    
                    this.updateTimerDisplay();
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±
                    if (this.timer.mode === 'focus') {
                        this.userData.stats.todayStudyTime++;
                        this.userData.stats.totalStudyTime++;
                        
                        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ø¯Ø±Ø®Øª
                        this.addTreeExperience(1);
                        
                        // Ø¨Ø±Ø±Ø³ÛŒ Ú†Ø§Ù„Ø´
                        this.challengeManager.updateChallengeProgress('study_time', 1);
                        
                        // Ø°Ø®ÛŒØ±Ù‡ Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
                        if (this.timer.totalSeconds % 30 === 0) {
                            this.statsManager.updateStudyStats();
                            this.saveUserData();
                        }
                    }
                    
                }, 1000);
                
                document.getElementById('startTimer').innerHTML = '<i class="fas fa-pause"></i><span>Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§</span>';
                document.getElementById('startTimer').classList.remove('btn-primary');
                document.getElementById('startTimer').classList.add('btn-secondary');
                
                this.showNotification('ØªØ§ÛŒÙ…Ø±', 'ØªØ§ÛŒÙ…Ø± Ø´Ø±ÙˆØ¹ Ø´Ø¯.');
            }
            
            pauseTimer() {
                if (!this.timer.isRunning) return;
                
                this.timer.isRunning = false;
                clearInterval(this.timerInterval);
                
                document.getElementById('startTimer').innerHTML = '<i class="fas fa-play"></i><span>Ø§Ø¯Ø§Ù…Ù‡</span>';
                document.getElementById('startTimer').classList.remove('btn-secondary');
                document.getElementById('startTimer').classList.add('btn-primary');
                
                this.showNotification('ØªØ§ÛŒÙ…Ø±', 'ØªØ§ÛŒÙ…Ø± Ù…ØªÙˆÙ‚Ù Ø´Ø¯.');
            }
            
            resetTimer() {
                this.pauseTimer();
                this.timer.totalSeconds = this.timer.mode === 'focus' ? this.timer.focusTime * 60 : this.timer.breakTime * 60;
                this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                this.timer.seconds = this.timer.totalSeconds % 60;
                this.updateTimerDisplay();
                this.showNotification('ØªØ§ÛŒÙ…Ø±', 'ØªØ§ÛŒÙ…Ø± Ø±ÛŒØ³Øª Ø´Ø¯.');
            }
            
            timerComplete() {
                this.pauseTimer();
                
                // Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ø§Ø¹Ù„Ø§Ù† â€“ Ø­Ø°Ù Ø´Ø¯
                
                // ÙˆÛŒØ¨Ø±ÛŒØ´Ù†
                if (this.userData.settings.notificationVibration && 'vibrate' in navigator) {
                    navigator.vibrate([200, 100, 200]);
                }
                
                if (this.timer.mode === 'focus') {
                    this.userData.stats.totalSessions++;
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§
                    this.checkAchievements();
                    
                    // Ø°Ø®ÛŒØ±Ù‡ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡
                    this.saveStudySession();
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú†Ø§Ù„Ø´
                    this.challengeManager.updateChallengeProgress('sessions', 1);
                    
                    if (this.userData.settings.timerNotification) {
                        this.showNotification('Ø¢ÙØ±ÛŒÙ†!', 'Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ ØªÙ…Ø§Ù… Ø´Ø¯. Ø§Ø³ØªØ±Ø§Ø­Øª Ú©Ù†ÛŒØ¯.');
                    }
                    
                    // Ø´Ø±ÙˆØ¹ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø³ØªØ±Ø§Ø­Øª
                    if (this.userData.settings.autoStartBreak > 0) {
                        setTimeout(() => {
                            this.timer.mode = 'break';
                            this.timer.totalSeconds = this.timer.breakTime * 60;
                            this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                            this.timer.seconds = this.timer.totalSeconds % 60;
                            this.updateTimerDisplay();
                            this.updateTimerModeDisplay();
                            this.startTimer();
                        }, this.userData.settings.autoStartBreak * 1000);
                    } else {
                        this.timer.mode = 'break';
                        this.timer.totalSeconds = this.timer.breakTime * 60;
                        this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                        this.timer.seconds = this.timer.totalSeconds % 60;
                        this.updateTimerDisplay();
                        this.updateTimerModeDisplay();
                    }
                } else {
                    this.timer.mode = 'focus';
                    this.timer.totalSeconds = this.timer.focusTime * 60;
                    this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                    this.timer.seconds = this.timer.totalSeconds % 60;
                    this.updateTimerDisplay();
                    this.updateTimerModeDisplay();
                    
                    if (this.userData.settings.timerNotification) {
                        this.showNotification('Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø§Ø´ÛŒØ¯!', 'Ø²Ù…Ø§Ù† Ø§Ø³ØªØ±Ø§Ø­Øª ØªÙ…Ø§Ù… Ø´Ø¯.');
                    }
                }
            }
            
            saveStudySession() {
                const today = new Date().toISOString().split('T')[0];
                const now = new Date();
                
                if (this.userData.stats.lastStudyDate !== today) {
                    const lastDate = this.userData.stats.lastStudyDate ? new Date(this.userData.stats.lastStudyDate) : null;
                    
                    if (lastDate) {
                        const diffDays = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24));
                        if (diffDays === 1) {
                            this.userData.stats.streakDays++;
                        } else if (diffDays > 1) {
                            this.userData.stats.streakDays = 1;
                        }
                    } else {
                        this.userData.stats.streakDays = 1;
                    }
                    
                    this.userData.stats.lastStudyDate = today;
                }
                
                this.userData.stats.totalHours = Math.floor(this.userData.stats.totalStudyTime / 60);
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡
                if (!this.userData.stats.studyDays[today]) {
                    this.userData.stats.studyDays[today] = 0;
                }
                this.userData.stats.studyDays[today] += this.timer.focusTime;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ²
                if (this.userData.stats.studyDays[today] > this.userData.stats.bestDay) {
                    this.userData.stats.bestDay = this.userData.stats.studyDays[today];
                }
                
                this.statsManager.updateStudyStats();
                this.saveUserData();
                this.updateUI();
            }
            
            updateTimerDisplay() {
                const display = document.getElementById('timerDisplay');
                const minutes = this.timer.minutes.toString().padStart(2, '0');
                const seconds = this.timer.seconds.toString().padStart(2, '0');
                display.textContent = `${minutes}:${seconds}`;
            }
            
            updateTimerModeDisplay() {
                const currentMode = this.userData.timerModes.current;
                const modeNames = {
                    pomodoro: 'Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ',
                    deep: 'Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¹Ù…ÛŒÙ‚',
                    sprint: 'Ø§Ø³Ù¾Ø±ÛŒÙ†Øª',
                    marathon: 'Ù…Ø§Ø±Ø§ØªÙ†',
                    custom: 'Ø³ÙØ§Ø±Ø´ÛŒ'
                };
                
                const mode = this.userData.timerModes[currentMode];
                const display = document.getElementById('timerModeDisplay');
                display.textContent = `${modeNames[currentMode]} (${mode.focus}/${mode.break})`;
            }
            
            cycleTimerMode() {
                const modes = ['pomodoro', 'deep', 'sprint', 'marathon', 'custom'];
                const currentIndex = modes.indexOf(this.userData.timerModes.current);
                const nextIndex = (currentIndex + 1) % modes.length;
                this.userData.timerModes.current = modes[nextIndex];
                
                this.updateTimerFromMode();
                this.updateTimerModeDisplay();
                this.saveUserData();
                
                this.showNotification('Ø­Ø§Ù„Øª ØªØ§ÛŒÙ…Ø±', `Ø­Ø§Ù„Øª ${this.getTimerModeName()} ÙØ¹Ø§Ù„ Ø´Ø¯.`);
            }
            
            getTimerModeName() {
                const names = {
                    pomodoro: 'Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ',
                    deep: 'Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¹Ù…ÛŒÙ‚',
                    sprint: 'Ø§Ø³Ù¾Ø±ÛŒÙ†Øª',
                    marathon: 'Ù…Ø§Ø±Ø§ØªÙ†',
                    custom: 'Ø³ÙØ§Ø±Ø´ÛŒ'
                };
                return names[this.userData.timerModes.current];
            }
            
            updateTimerFromMode() {
                const currentMode = this.userData.timerModes.current;
                const mode = this.userData.timerModes[currentMode];
                
                this.timer.focusTime = mode.focus;
                this.timer.breakTime = mode.break;
                
                if (this.timer.mode === 'focus') {
                    this.timer.totalSeconds = mode.focus * 60;
                } else {
                    this.timer.totalSeconds = mode.break * 60;
                }
                
                this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                this.timer.seconds = this.timer.totalSeconds % 60;
                
                this.updateTimerDisplay();
            }
            
            showTimerModal() {
                // ØªÙ†Ø¸ÛŒÙ… Ú¯Ø²ÛŒÙ†Ù‡ ÙØ¹Ù„ÛŒ
                document.querySelectorAll('.timer-mode-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.mode === this.userData.timerModes.current) {
                        option.classList.add('active');
                    }
                });
                
                // Ù†Ù…Ø§ÛŒØ´ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³ÙØ§Ø±Ø´ÛŒ
                const customSettings = document.getElementById('customTimerSettings');
                if (this.userData.timerModes.current === 'custom') {
                    customSettings.style.display = 'block';
                    document.getElementById('customFocusTime').value = this.userData.timerModes.custom.focus;
                    document.getElementById('customBreakTime').value = this.userData.timerModes.custom.break;
                } else {
                    customSettings.style.display = 'none';
                }
                
                this.showModal('timerModal');
            }
            
            selectTimerMode(mode) {
                document.querySelectorAll('.timer-mode-option').forEach(option => {
                    option.classList.remove('active');
                });
                event.currentTarget.classList.add('active');
                
                if (mode === 'custom') {
                    document.getElementById('customTimerSettings').style.display = 'block';
                } else {
                    document.getElementById('customTimerSettings').style.display = 'none';
                }
                
                this.userData.timerModes.current = mode;
            }
            
            saveTimerSettings() {
                if (this.userData.timerModes.current === 'custom') {
                    const focusTime = parseInt(document.getElementById('customFocusTime').value);
                    const breakTime = parseInt(document.getElementById('customBreakTime').value);
                    
                    if (focusTime < 5 || focusTime > 180 || breakTime < 1 || breakTime > 30) {
                        this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                        return;
                    }
                    
                    this.userData.timerModes.custom = { focus: focusTime, break: breakTime };
                }
                
                this.updateTimerFromMode();
                this.updateTimerModeDisplay();
                this.saveUserData();
                this.hideModal('timerModal');
                
                this.showNotification('ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÙ…Ø±', 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.');
            }
            
            loadQuotes() {
                this.quotes = [
                    { text: "Ù…ÙˆÙÙ‚ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ Ù†ÛŒØ³ØªØŒ Ø´Ú©Ø³Øª Ù…Ø±Ú¯Ø¨Ø§Ø± Ù†ÛŒØ³ØªØ› Ø´Ø¬Ø§Ø¹Øª Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø¯Ù† Ø§Ø³Øª Ú©Ù‡ Ø§Ù‡Ù…ÛŒØª Ø¯Ø§Ø±Ø¯.", author: "ÙˆÛŒÙ†Ø³ØªÙˆÙ† Ú†Ø±Ú†ÛŒÙ„" },
                    { text: "Ø¢ÛŒÙ†Ø¯Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø³Ø§Ù†ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯Ù†Ø´ Ø§Ù…Ø±ÙˆØ² ØªÙ„Ø§Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.", author: "Ù…Ø§Ù„Ú©ÙˆÙ… Ø§ÛŒÚ©Ø³" },
                    { text: "Ø±Ù…Ø² Ù…ÙˆÙÙ‚ÛŒØª Ø´Ø±ÙˆØ¹ Ú©Ø±Ø¯Ù† Ø§Ø³Øª. Ø±Ù…Ø² Ø´Ø±ÙˆØ¹ Ú©Ø±Ø¯Ù†ØŒ ØªÙ‚Ø³ÛŒÙ… Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø³Ø®Øª Ø¨Ù‡ Ú©Ø§Ø±Ù‡Ø§ÛŒ Ú©ÙˆÚ†Ú© Ùˆ Ø³Ù¾Ø³ Ø´Ø±ÙˆØ¹ Ø¨Ø§ Ø§ÙˆÙ„ÛŒÙ† Ú©Ø§Ø± Ø§Ø³Øª.", author: "Ù…Ø§Ø±Ú© ØªÙˆØ§ÛŒÙ†" },
                    { text: "ØªÙ†Ù‡Ø§ Ø±Ø§Ù‡ Ø§Ù†Ø¬Ø§Ù… Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ØŒ Ø¯ÙˆØ³Øª Ø¯Ø§Ø´ØªÙ† Ú©Ø§Ø±ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡ÛŒ.", author: "Ø§Ø³ØªÛŒÙˆ Ø¬Ø§Ø¨Ø²" },
                    { text: "Ù‡ÛŒÚ† Ú†ÛŒØ² ØºÛŒØ±Ù…Ù…Ú©Ù† Ù†ÛŒØ³ØªØŒ Ø®ÙˆØ¯ Ú©Ù„Ù…Ù‡ Ù…ÛŒâ€ŒÚ¯ÙˆÛŒØ¯ Ù…Ù† Ù…Ù…Ú©Ù†Ù…!", author: "Ø¢Ø¯Ø±ÛŒ Ù‡Ù¾Ø¨ÙˆØ±Ù†" },
                    { text: "Ø³Ø®Øªâ€ŒØªØ±ÛŒÙ† Ú©Ø§Ø± Ø¯Ø± Ø¯Ù†ÛŒØ§ Ø§ÛŒÙ† Ø§Ø³Øª Ú©Ù‡ Ø°Ù‡Ù† Ø§Ù†Ø³Ø§Ù† Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒ.", author: "Ø§Ø³Ù¾ÛŒÙ†ÙˆØ²Ø§" },
                    { text: "Ù…Ù‡Ù… Ù†ÛŒØ³Øª Ú†Ù‚Ø¯Ø± Ø¢Ù‡Ø³ØªÙ‡ Ù¾ÛŒØ´ Ù…ÛŒâ€ŒØ±ÙˆÛŒØŒ ØªØ§ ÙˆÙ‚ØªÛŒ Ú©Ù‡ Ù…ØªÙˆÙ‚Ù Ù†Ø´ÙˆÛŒ.", author: "Ú©Ù†ÙÛŒØ³ÛŒÙˆØ³" },
                    { text: "Ø¢Ù…ÙˆØ²Ø´ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ø³Ù„Ø§Ø­ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø¬Ù‡Ø§Ù† Ø§Ø² Ø¢Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ.", author: "Ù†Ù„Ø³ÙˆÙ† Ù…Ø§Ù†Ø¯Ù„Ø§" },
                    { text: "Ù…ÙˆÙÙ‚ÛŒØª Ù…Ø³ÛŒØ±ÛŒ Ø§Ø³Øª Ù†Ù‡ Ù…Ù‚ØµØ¯.", author: "Ø¢Ù†ØªÙˆÙ†ÛŒ Ø±Ø§Ø¨ÛŒÙ†Ø²" },
                    { text: "Ù‡Ø±Ú†Ù‡ Ø¨ÛŒØ´ØªØ± Ø¨Ø®ÙˆØ§Ù†ÛŒØŒ Ú†ÛŒØ²Ù‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø®ÙˆØ§Ù‡ÛŒ Ø¯Ø§Ù†Ø³Øª. Ù‡Ø±Ú†Ù‡ Ø¨ÛŒØ´ØªØ± Ø¨ÛŒØ§Ù…ÙˆØ²ÛŒØŒ Ø¨Ù‡ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø®ÙˆØ§Ù‡ÛŒ Ø±ÙØª.", author: "Ø¯Ú©ØªØ± Ø³ÙˆØ³" },
                    { text: "ØªÙ†Ù‡Ø§ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ Ø¢Ù†Ù‡Ø§ÛŒÛŒ Ù‡Ø³ØªÙ†Ø¯ Ú©Ù‡ Ø¯Ø± Ø°Ù‡Ù† Ø®ÙˆØ¯Ù…Ø§Ù† Ù…ÛŒâ€ŒØ³Ø§Ø²ÛŒÙ….", author: "Ù†Ø§Ù¾Ù„Ø¦ÙˆÙ† Ù‡ÛŒÙ„" },
                    { text: "Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡ØŒ Ø³Ø§Ø®ØªÙ† Ø¢Ù† Ø§Ø³Øª.", author: "Ù¾ÛŒØªØ± Ø¯Ø±Ø§Ú©Ø±" }
                ];
                
                this.showRandomQuote();
            }
            
            loadChallenges() {
                this.challenges = [
                    { id: 'morning_study', type: 'study_time', target: 60, description: 'ØµØ¨Ø­ Ø²ÙˆØ¯ Û¶Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ù†', reward: 50 },
                    { id: 'three_sessions', type: 'sessions', target: 3, description: 'Ø§Ù…Ø±ÙˆØ² Û³ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´', reward: 75 },
                    { id: 'complete_goal', type: 'goal', target: 100, description: 'Ø¨Ù‡ Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡â€ŒØ§Øª Ø¨Ø±Ø³', reward: 100 },
                    { id: 'review_cards', type: 'review', target: 10, description: 'Û±Û° ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ù…Ø±ÙˆØ± Ú©Ù†', reward: 60 },
                    { id: 'take_breaks', type: 'breaks', target: 3, description: 'Û³ Ø§Ø³ØªØ±Ø§Ø­Øª ØµØ­ÛŒØ­ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´', reward: 40 }
                ];
            }
            
            showRandomQuote() {
                if (this.quotes.length === 0) return;
                
                const randomIndex = Math.floor(Math.random() * this.quotes.length);
                const quote = this.quotes[randomIndex];
                
                document.getElementById('dailyQuote').textContent = `"${quote.text}"`;
                document.getElementById('quoteAuthor').textContent = `- ${quote.author}`;
                
                // Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
                if (this.userData.settings.animations) {
                    const quoteBox = document.getElementById('quoteBox');
                    quoteBox.style.transform = 'translateY(-5px)';
                    setTimeout(() => {
                        quoteBox.style.transform = 'translateY(0)';
                    }, 300);
                }
            }
            
            toggleChallenge() {
                const challengeCard = document.getElementById('dailyChallengeCard');
                if (challengeCard.style.display === 'none') {
                    this.challengeManager.showDailyChallenge();
                } else {
                    challengeCard.style.display = 'none';
                }
            }
            
            addTreeExperience(amount) {
                this.userData.tree.experience += amount;
                
                if (this.userData.tree.experience >= this.userData.tree.maxExperience) {
                    this.userData.tree.level++;
                    this.userData.tree.experience = 0;
                    this.userData.tree.maxExperience = Math.floor(this.userData.tree.maxExperience * 1.2);
                    
                    this.showNotification('ØªØ¨Ø±ÛŒÚ©!', `Ø³Ø·Ø­ Ø¯Ø±Ø®Øª Ø´Ù…Ø§ Ø¨Ù‡ ${this.userData.tree.level} Ø§Ø±ØªÙ‚Ø§Ø¡ ÛŒØ§ÙØª!`);
                    // Ù¾Ø®Ø´ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ø³Ø·Ø­
                    this.checkAchievements();
                }
                
                this.updateTreeUI();
                this.saveUserData();
            }
            
            updateTreeUI() {
                const progress = Math.min(100, (this.userData.tree.experience / this.userData.tree.maxExperience) * 100);
                
                document.getElementById('treeProgress').style.width = `${progress}%`;
                document.getElementById('treeProgressText').textContent = Math.floor(progress);
                document.getElementById('treeLevel').textContent = this.userData.tree.level;
                document.getElementById('treeExperience').textContent = this.userData.tree.experience;
                document.getElementById('treeMaxExperience').textContent = this.userData.tree.maxExperience;
                
                // ØªØºÛŒÛŒØ± Ø¢ÛŒÚ©ÙˆÙ† Ø¯Ø±Ø®Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø·Ø­
                const treeIcon = document.getElementById('treeIcon');
                let newIcon = 'ğŸŒ±';
                
                if (this.userData.tree.level >= 20) {
                    newIcon = 'ğŸŒ³ğŸŒ³';
                } else if (this.userData.tree.level >= 15) {
                    newIcon = 'ğŸŒ³';
                } else if (this.userData.tree.level >= 10) {
                    newIcon = 'ğŸŒ²ğŸŒ²';
                } else if (this.userData.tree.level >= 5) {
                    newIcon = 'ğŸŒ²';
                } else if (this.userData.tree.level >= 3) {
                    newIcon = 'ğŸ„';
                }
                
                if (treeIcon.textContent !== newIcon) {
                    treeIcon.textContent = newIcon;
                }
            }
            
            animateTree() {
                if (!this.userData.settings.animations) return;
                
                const treeIcon = document.getElementById('treeIcon');
                treeIcon.style.transform = 'scale(1.2)';
                treeIcon.style.transition = 'transform 0.3s ease';
                
                setTimeout(() => {
                    treeIcon.style.transform = 'scale(1)';
                }, 300);
                
                this.showNotification('Ø¯Ø±Ø®Øª ØªÙ…Ø±Ú©Ø²', `Ø³Ø·Ø­ ${this.userData.tree.level} - ${this.userData.tree.experience}/${this.userData.tree.maxExperience} ØªØ¬Ø±Ø¨Ù‡`);
            }
            
            showTreeInfo() {
                this.showNotification('Ø¯Ø±Ø®Øª ØªÙ…Ø±Ú©Ø²', `
                    Ù‡Ø± Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ = 1 ØªØ¬Ø±Ø¨Ù‡
                    Ø³Ø·Ø­ ÙØ¹Ù„ÛŒ: ${this.userData.tree.level}
                    ØªØ¬Ø±Ø¨Ù‡: ${this.userData.tree.experience}/${this.userData.tree.maxExperience}
                    ${this.userData.tree.level >= 20 ? 'ğŸ‰ Ø´Ù…Ø§ Ø¨Ù‡ Ø³Ø·Ø­ Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø³ÛŒØ¯Ù‡â€ŒØ§ÛŒØ¯!' : `ØªØ§ Ø³Ø·Ø­ Ø¨Ø¹Ø¯ÛŒ: ${this.userData.tree.maxExperience - this.userData.tree.experience} ØªØ¬Ø±Ø¨Ù‡`}
                `);
            }
            
            checkAchievements() {
                const achievements = [
                    { id: 'first_session', title: 'Ø´Ø±ÙˆØ¹ Ú©Ù†Ù†Ø¯Ù‡', desc: 'Ø§ÙˆÙ„ÛŒÙ† Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-play', condition: () => this.userData.stats.totalSessions >= 1 },
                    { id: 'five_sessions', title: 'Ù…ØªØ¹Ù‡Ø¯', desc: 'Ûµ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-fire', condition: () => this.userData.stats.totalSessions >= 5 },
                    { id: 'ten_sessions', title: 'Ø³Ø®Øªâ€ŒÚ©ÙˆØ´', desc: 'Û±Û° Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-trophy', condition: () => this.userData.stats.totalSessions >= 10 },
                    { id: 'twenty_sessions', title: 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ', desc: 'Û²Û° Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-crown', condition: () => this.userData.stats.totalSessions >= 20 },
                    { id: 'streak_3', title: 'Ø³Ù‡ Ø±ÙˆØ²Ù‡', desc: 'Û³ Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar', condition: () => this.userData.stats.streakDays >= 3 },
                    { id: 'streak_7', title: 'Ù‡ÙØªÙ‡â€ŒØ§ÛŒ', desc: 'Û· Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar-alt', condition: () => this.userData.stats.streakDays >= 7 },
                    { id: 'streak_30', title: 'Ù…Ø§Ù‡Ø§Ù†Ù‡', desc: 'Û³Û° Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar-star', condition: () => this.userData.stats.streakDays >= 30 },
                    { id: 'tree_level_3', title: 'Ø±Ø´Ø¯ Ú©Ø±Ø¯Ù‡', desc: 'Ø³Ø·Ø­ Û³ Ø¯Ø±Ø®Øª', icon: 'fa-seedling', condition: () => this.userData.tree.level >= 3 },
                    { id: 'tree_level_5', title: 'Ø¯Ø±Ø®Øª Ú©Ø§Ù…Ù„', desc: 'Ø³Ø·Ø­ Ûµ Ø¯Ø±Ø®Øª', icon: 'fa-tree', condition: () => this.userData.tree.level >= 5 },
                    { id: 'tree_level_10', title: 'Ø¬Ù†Ú¯Ù„ Ø¨Ø§Ù†', desc: 'Ø³Ø·Ø­ Û±Û° Ø¯Ø±Ø®Øª', icon: 'fa-forest', condition: () => this.userData.tree.level >= 10 },
                    { id: 'tree_level_20', title: 'Ø¨Ø§ØºØ¨Ø§Ù† Ø§Ø³ØªØ§Ø¯', desc: 'Ø³Ø·Ø­ Û²Û° Ø¯Ø±Ø®Øª', icon: 'fa-mountain', condition: () => this.userData.tree.level >= 20 },
                    { id: 'one_hour', title: 'Ø³Ø§Ø¹Øªâ€ŒÚ©Ø´', desc: 'Û± Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-clock', condition: () => this.userData.stats.totalHours >= 1 },
                    { id: 'five_hours', title: 'Ù…Ø·Ø§Ù„Ø¹Ù‡â€ŒÚ¯Ø±', desc: 'Ûµ Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-graduation-cap', condition: () => this.userData.stats.totalHours >= 5 },
                    { id: 'twenty_hours', title: 'Ù…Ø­Ù‚Ù‚', desc: 'Û²Û° Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-user-graduate', condition: () => this.userData.stats.totalHours >= 20 },
                    { id: 'fifty_hours', title: 'Ø¯Ø§Ù†Ø´Ù…Ù†Ø¯', desc: 'ÛµÛ° Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-atom', condition: () => this.userData.stats.totalHours >= 50 },
                    { id: 'pdf_master', title: 'Ú©ØªØ§Ø¨Ø®ÙˆØ§Ù†', desc: 'Ø¢Ù¾Ù„ÙˆØ¯ Û³ PDF', icon: 'fa-file-pdf', condition: () => this.userData.pdfs.length >= 3 },
                    { id: 'flashcard_master', title: 'Ø­Ø§ÙØ¸Ù‡ Ù‚ÙˆÛŒ', desc: 'Ø³Ø§Ø®Øª Ûµ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª', icon: 'fa-lightbulb', condition: () => this.userData.flashcards.length >= 5 },
                    { id: 'note_master', title: 'ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ù†ÙˆÛŒØ³', desc: 'Ø§ÛŒØ¬Ø§Ø¯ Û±Û° ÛŒØ§Ø¯Ø¯Ø§Ø´Øª', icon: 'fa-sticky-note', condition: () => this.userData.notes.length >= 10 },
                    { id: 'review_master', title: 'Ù…Ø±ÙˆØ± Ú©Ù†Ù†Ø¯Ù‡', desc: 'Ù…Ø±ÙˆØ± ÛµÛ° Ú©Ø§Ø±Øª', icon: 'fa-brain', condition: () => this.userData.reviews.stats.totalReviews >= 50 }
                    // Ø¯Ø³ØªØ§ÙˆØ±Ø¯ all_sounds Ø­Ø°Ù Ø´Ø¯
                ];
                
                let newAchievements = 0;
                
                achievements.forEach(ach => {
                    if (ach.condition() && !this.userData.achievements.includes(ach.id)) {
                        this.userData.achievements.push(ach.id);
                        newAchievements++;
                        
                        this.showNotification('ğŸ‰ Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯!', ach.title);
                        // Ù¾Ø®Ø´ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
                        
                        // Ø§ÙØ²ÙˆØ¯Ù† Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
                        this.addNotification({
                            title: 'Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯',
                            message: `Ø¯Ø³ØªØ§ÙˆØ±Ø¯ "${ach.title}" Ø¨Ø§Ø² Ø´Ø¯!`,
                            time: new Date().toLocaleTimeString('fa-IR'),
                            read: false,
                            type: 'achievement'
                        });
                        
                        // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                        this.addTreeExperience(25);
                    }
                });
                
                if (newAchievements > 0) {
                    this.saveUserData();
                    this.loadAchievements();
                }
            }
            
            loadAchievements() {
                const achievementsGrid = document.getElementById('achievementsGrid');
                const achievements = [
                    { id: 'first_session', title: 'Ø´Ø±ÙˆØ¹ Ú©Ù†Ù†Ø¯Ù‡', desc: 'Ø§ÙˆÙ„ÛŒÙ† Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-play' },
                    { id: 'five_sessions', title: 'Ù…ØªØ¹Ù‡Ø¯', desc: 'Ûµ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-fire' },
                    { id: 'ten_sessions', title: 'Ø³Ø®Øªâ€ŒÚ©ÙˆØ´', desc: 'Û±Û° Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-trophy' },
                    { id: 'twenty_sessions', title: 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ', desc: 'Û²Û° Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-crown' },
                    { id: 'streak_3', title: 'Ø³Ù‡ Ø±ÙˆØ²Ù‡', desc: 'Û³ Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar' },
                    { id: 'streak_7', title: 'Ù‡ÙØªÙ‡â€ŒØ§ÛŒ', desc: 'Û· Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar-alt' },
                    { id: 'streak_30', title: 'Ù…Ø§Ù‡Ø§Ù†Ù‡', desc: 'Û³Û° Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ', icon: 'fa-calendar-star' },
                    { id: 'tree_level_3', title: 'Ø±Ø´Ø¯ Ú©Ø±Ø¯Ù‡', desc: 'Ø³Ø·Ø­ Û³ Ø¯Ø±Ø®Øª', icon: 'fa-seedling' },
                    { id: 'tree_level_5', title: 'Ø¯Ø±Ø®Øª Ú©Ø§Ù…Ù„', desc: 'Ø³Ø·Ø­ Ûµ Ø¯Ø±Ø®Øª', icon: 'fa-tree' },
                    { id: 'tree_level_10', title: 'Ø¬Ù†Ú¯Ù„ Ø¨Ø§Ù†', desc: 'Ø³Ø·Ø­ Û±Û° Ø¯Ø±Ø®Øª', icon: 'fa-forest' },
                    { id: 'tree_level_20', title: 'Ø¨Ø§ØºØ¨Ø§Ù† Ø§Ø³ØªØ§Ø¯', desc: 'Ø³Ø·Ø­ Û²Û° Ø¯Ø±Ø®Øª', icon: 'fa-mountain' },
                    { id: 'one_hour', title: 'Ø³Ø§Ø¹Øªâ€ŒÚ©Ø´', desc: 'Û± Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-clock' },
                    { id: 'five_hours', title: 'Ù…Ø·Ø§Ù„Ø¹Ù‡â€ŒÚ¯Ø±', desc: 'Ûµ Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-graduation-cap' },
                    { id: 'twenty_hours', title: 'Ù…Ø­Ù‚Ù‚', desc: 'Û²Û° Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-user-graduate' },
                    { id: 'fifty_hours', title: 'Ø¯Ø§Ù†Ø´Ù…Ù†Ø¯', desc: 'ÛµÛ° Ø³Ø§Ø¹Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', icon: 'fa-atom' },
                    { id: 'pdf_master', title: 'Ú©ØªØ§Ø¨Ø®ÙˆØ§Ù†', desc: 'Ø¢Ù¾Ù„ÙˆØ¯ Û³ PDF', icon: 'fa-file-pdf' },
                    { id: 'flashcard_master', title: 'Ø­Ø§ÙØ¸Ù‡ Ù‚ÙˆÛŒ', desc: 'Ø³Ø§Ø®Øª Ûµ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª', icon: 'fa-lightbulb' },
                    { id: 'note_master', title: 'ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ù†ÙˆÛŒØ³', desc: 'Ø§ÛŒØ¬Ø§Ø¯ Û±Û° ÛŒØ§Ø¯Ø¯Ø§Ø´Øª', icon: 'fa-sticky-note' },
                    { id: 'review_master', title: 'Ù…Ø±ÙˆØ± Ú©Ù†Ù†Ø¯Ù‡', desc: 'Ù…Ø±ÙˆØ± ÛµÛ° Ú©Ø§Ø±Øª', icon: 'fa-brain' }
                    // all_sounds Ø­Ø°Ù Ø´Ø¯
                ];
                
                achievementsGrid.innerHTML = '';
                
                achievements.forEach(ach => {
                    const unlocked = this.userData.achievements.includes(ach.id);
                    const item = document.createElement('div');
                    item.className = `achievement-item ${unlocked ? 'unlocked' : ''}`;
                    item.title = unlocked ? `${ach.desc} - Ø¨Ø§Ø² Ø´Ø¯Ù‡` : `${ach.desc} - Ù‚ÙÙ„ Ø§Ø³Øª`;
                    item.innerHTML = `
                        <div class="achievement-icon">
                            <i class="fas ${ach.icon}"></i>
                        </div>
                        <div class="achievement-title">${ach.title}</div>
                        <div class="achievement-desc">${ach.desc}</div>
                    `;
                    
                    if (unlocked) {
                        item.addEventListener('click', () => {
                            this.showNotification(ach.title, ach.desc);
                        });
                    }
                    
                    achievementsGrid.appendChild(item);
                });
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡
                document.getElementById('achievementsCount').textContent = 
                    `${this.userData.achievements.length}/${achievements.length}`;
            }
            
            changeTheme(theme) {
                this.currentTheme = theme;
                document.body.setAttribute('data-theme', theme);
                this.userData.settings.theme = theme;
                this.saveUserData();
                
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.theme === theme) {
                        option.classList.add('active');
                    }
                });
                
                this.showNotification('ØªÙ…', `ØªÙ… "${this.getThemeName(theme)}" ÙØ¹Ø§Ù„ Ø´Ø¯.`);
            }
            
            getThemeName(theme) {
                const names = {
                    'default': 'Ù¾ÛŒØ´â€ŒÙØ±Ø¶',
                    'nature': 'Ø·Ø¨ÛŒØ¹Øª',
                    'energy': 'Ø§Ù†Ø±Ú˜ÛŒ',
                    'professional': 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ',
                    'calm': 'Ø¢Ø±Ø§Ù…Ø´'
                };
                return names[theme] || theme;
            }
            
            toggleDarkMode(force = null) {
                if (force !== null) {
                    this.isDarkMode = force;
                } else {
                    this.isDarkMode = !this.isDarkMode;
                }
                
                if (this.isDarkMode) {
                    document.body.classList.add('dark-mode');
                    document.getElementById('darkModeSwitch').checked = true;
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    document.body.classList.remove('dark-mode');
                    document.getElementById('darkModeSwitch').checked = false;
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-moon"></i>';
                }
                
                this.userData.settings.darkMode = this.isDarkMode;
                this.saveUserData();
            }
            
            toggleLargeFont(enabled) {
                if (enabled) {
                    document.body.style.fontSize = '16px';
                } else {
                    document.body.style.fontSize = '14px';
                }
            }
            
            setupTheme() {
                document.body.setAttribute('data-theme', this.currentTheme);
                
                if (this.isDarkMode) {
                    document.body.classList.add('dark-mode');
                    document.getElementById('darkModeSwitch').checked = true;
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-moon"></i>';
                }
                
                if (this.userData.settings.largeFont) {
                    document.getElementById('largeFontToggle').checked = true;
                    this.toggleLargeFont(true);
                }
                
                if (this.userData.settings.animations) {
                    document.getElementById('animationsToggle').checked = true;
                }
                
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.theme === this.currentTheme) {
                        option.classList.add('active');
                    }
                });
            }
            
            setupNotifications() {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§
                document.getElementById('morningReminder').value = this.userData.reminders.morning.time;
                document.getElementById('morningReminderToggle').checked = this.userData.reminders.morning.enabled;
                document.getElementById('afternoonReminder').value = this.userData.reminders.afternoon.time;
                document.getElementById('afternoonReminderToggle').checked = this.userData.reminders.afternoon.enabled;
                document.getElementById('eveningReminder').value = this.userData.reminders.evening.time;
                document.getElementById('eveningReminderToggle').checked = this.userData.reminders.evening.enabled;
                
                document.getElementById('notificationSoundToggle').checked = this.userData.settings.notificationSound;
                document.getElementById('notificationVibrationToggle').checked = this.userData.settings.notificationVibration;
                document.getElementById('eyeBreakToggle').checked = this.userData.settings.eyeBreak;
                document.getElementById('stretchBreakToggle').checked = this.userData.settings.stretchBreak;
                document.getElementById('timerSoundToggle').checked = this.userData.settings.timerSound;
                document.getElementById('timerNotificationToggle').checked = this.userData.settings.timerNotification;
                document.getElementById('autoStartBreak').value = this.userData.settings.autoStartBreak;
                document.getElementById('encryptionToggle').checked = this.userData.settings.encryption;
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§
                this.loadNotifications();
                
                // ØªÙ†Ø¸ÛŒÙ… ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø´Ø¯Ù‡
                this.setupScheduledReminders();
            }
            
            setupScheduledReminders() {
                // Ú†Ú© Ú©Ø±Ø¯Ù† ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§ Ù‡Ø± Ø¯Ù‚ÛŒÙ‚Ù‡
                setInterval(() => {
                    this.checkReminders();
                    this.healthManager.checkHealthReminders();
                }, 60000);
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† ØªØ§ÛŒÙ…Ø± Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
                setInterval(() => {
                    this.checkTimersAfterBackground();
                }, 5000);
            }
            
            checkReminders() {
                const now = new Date();
                const currentTime = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ ØµØ¨Ø­
                if (this.userData.reminders.morning.enabled && currentTime === this.userData.reminders.morning.time) {
                    this.addNotification({
                        title: 'ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ ØµØ¨Ø­',
                        message: 'Ø²Ù…Ø§Ù† Ù…Ø·Ø§Ù„Ø¹Ù‡ ÙØ±Ø§ Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª! Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ø±ÙˆØ² Ù¾Ø± Ø§Ø² Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù…Ø§Ø¯Ù‡ Ø´ÙˆÛŒØ¯.',
                        time: 'Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†',
                        read: false,
                        type: 'reminder'
                    });
                }
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø¨Ø¹Ø¯Ø§Ø²Ø¸Ù‡Ø±
                if (this.userData.reminders.afternoon.enabled && currentTime === this.userData.reminders.afternoon.time) {
                    this.addNotification({
                        title: 'ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø¨Ø¹Ø¯Ø§Ø²Ø¸Ù‡Ø±',
                        message: 'Ø¨Ù‡ØªØ±ÛŒÙ† Ø²Ù…Ø§Ù† Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ± Ø¯Ø±Ø³â€ŒÙ‡Ø§! Ø¨ÛŒØ§ÛŒÛŒØ¯ Ú©Ù…ÛŒ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ù†ÛŒÙ….',
                        time: 'Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†',
                        read: false,
                        type: 'reminder'
                    });
                }
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø´Ø¨
                if (this.userData.reminders.evening.enabled && currentTime === this.userData.reminders.evening.time) {
                    this.addNotification({
                        title: 'ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø´Ø¨',
                        message: 'Ø¢Ø®Ø±ÛŒÙ† ÙØ±ØµØª Ø§Ù…Ø±ÙˆØ² Ø¨Ø±Ø§ÛŒ Ù…Ø·Ø§Ù„Ø¹Ù‡! Ø§Ø² Ø¢Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.',
                        time: 'Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†',
                        read: false,
                        type: 'reminder'
                    });
                }
            }
            
            checkTimersAfterBackground() {
                // Ø§Ú¯Ø± ØªØ§ÛŒÙ…Ø± Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª Ùˆ ØµÙØ­Ù‡ Ù…Ø±Ø¦ÛŒ Ù†ÛŒØ³Øª
                if (this.timer && this.timer.isRunning && document.hidden) {
                    const now = Date.now();
                    if (now >= this.timer.endTime) {
                        this.timerComplete();
                    }
                }
            }
            
            saveReminders() {
                this.userData.reminders = {
                    morning: {
                        enabled: document.getElementById('morningReminderToggle').checked,
                        time: document.getElementById('morningReminder').value
                    },
                    afternoon: {
                        enabled: document.getElementById('afternoonReminderToggle').checked,
                        time: document.getElementById('afternoonReminder').value
                    },
                    evening: {
                        enabled: document.getElementById('eveningReminderToggle').checked,
                        time: document.getElementById('eveningReminder').value
                    }
                };
                
                this.saveUserData();
                this.showNotification('ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§', 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.');
            }
            
            addNotification(notification) {
                notification.id = Date.now();
                notification.timestamp = new Date().toISOString();
                this.userData.notifications.unshift(notification);
                
                // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§
                if (this.userData.notifications.length > 100) {
                    this.userData.notifications = this.userData.notifications.slice(0, 100);
                }
                
                this.saveUserData();
                this.updateNotificationBadge();
                
                if (this.currentPage === 'notifications') {
                    this.loadNotifications();
                }
            }
            
            loadNotifications() {
                const notificationsList = document.getElementById('notificationsList');
                notificationsList.innerHTML = '';
                
                if (this.userData.notifications.length === 0) {
                    notificationsList.innerHTML = `
                        <div style="text-align: center; padding: 40px 20px; opacity: 0.5;">
                            <i class="fas fa-bell-slash" style="font-size: 40px; margin-bottom: 16px;"></i>
                            <p>Ù‡ÛŒÚ† Ø§Ø¹Ù„Ø§Ù†ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>
                        </div>
                    `;
                    return;
                }
                
                this.userData.notifications.forEach(notification => {
                    const item = document.createElement('div');
                    item.className = `notification-item ${notification.read ? '' : 'unread'}`;
                    item.innerHTML = `
                        <div class="notification-actions">
                            <button class="notification-btn mark-read" data-id="${notification.id}" title="${notification.read ? 'Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù†Ø´Ø¯Ù‡' : 'Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡'}">
                                <i class="fas ${notification.read ? 'fa-envelope-open' : 'fa-envelope'}"></i>
                            </button>
                            <button class="notification-btn delete-notification" data-id="${notification.id}" title="Ø­Ø°Ù Ø§Ø¹Ù„Ø§Ù†">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="notification-header">
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-time">${notification.time}</div>
                        </div>
                        <div class="notification-message">${notification.message}</div>
                    `;
                    notificationsList.appendChild(item);
                });
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                document.querySelectorAll('.mark-read').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = parseInt(btn.dataset.id);
                        this.toggleNotificationRead(id);
                    });
                });
                
                document.querySelectorAll('.delete-notification').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = parseInt(btn.dataset.id);
                        this.deleteNotification(id);
                    });
                });
                
                this.updateNotificationBadge();
            }
            
            toggleNotificationRead(id) {
                const notification = this.userData.notifications.find(n => n.id === id);
                if (notification) {
                    notification.read = !notification.read;
                    this.saveUserData();
                    this.loadNotifications();
                }
            }
            
            deleteNotification(id) {
                this.userData.notifications = this.userData.notifications.filter(n => n.id !== id);
                this.saveUserData();
                this.loadNotifications();
            }
            
            markAllNotificationsAsRead() {
                this.userData.notifications.forEach(notification => {
                    notification.read = true;
                });
                this.saveUserData();
                this.loadNotifications();
                this.showNotification('Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§', 'Ù‡Ù…Ù‡ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù†Ø¯.');
            }
            
            clearNotifications() {
                if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ')) {
                    this.userData.notifications = [];
                    this.saveUserData();
                    this.loadNotifications();
                    this.showNotification('Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§', 'Ù‡Ù…Ù‡ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯.');
                }
            }
            
            updateNotificationBadge() {
                const unreadCount = this.userData.notifications.filter(n => !n.read).length;
                const badge = document.getElementById('notificationCount');
                
                if (unreadCount > 0) {
                    badge.textContent = unreadCount > 9 ? '9+' : unreadCount;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
            
            showPage(pageId) {
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                document.getElementById(`${pageId}-page`).classList.add('active');
                this.currentPage = pageId;
                
                switch(pageId) {
                    case 'library':
                        this.loadPDFs();
                        this.loadFlashcards();
                        this.loadNotes();
                        this.updateReviewStats();
                        break;
                    case 'notifications':
                        this.loadNotifications();
                        // Ù‡Ù†Ú¯Ø§Ù… Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§ØŒ Ù‡Ù…Ù‡ Ø±Ø§ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¹Ù„Ø§Ù…Øª Ø¨Ø²Ù†
                        setTimeout(() => this.markAllNotificationsAsRead(), 1000);
                        break;
                    case 'dashboard':
                        this.loadAchievements();
                        this.updateTreeUI();
                        this.challengeManager.updateChallengeUI();
                        break;
                    case 'focus':
                        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµØ¯Ø§Ù‡Ø§ Ø­Ø°Ù Ø´Ø¯
                        this.healthManager.updateHealthUI();
                        break;
                    case 'settings':
                        this.updateStatsUI();
                        this.storage.updateStorageInfo();
                        break;
                }
            }
            
            showTab(tabId) {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.style.display = 'none';
                });
                document.getElementById(`${tabId}-tab`).style.display = 'block';
                
                if (tabId === 'spaced') {
                    this.updateReviewStats();
                }
            }
            
            async uploadPDF(file) {
                if (!file || !file.type.includes('pdf')) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ ÛŒÚ© ÙØ§ÛŒÙ„ PDF Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                if (file.size > 10 * 1024 * 1024) {
                    this.showNotification('Ø®Ø·Ø§', 'Ø­Ø¬Ù… ÙØ§ÛŒÙ„ Ù†Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² Û±Û° Ù…Ú¯Ø§Ø¨Ø§ÛŒØª Ø¨Ø§Ø´Ø¯');
                    return;
                }
                
                this.showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„...');
                
                try {
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¢Ù¾Ù„ÙˆØ¯
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    const pdfData = {
                        id: Date.now(),
                        name: file.name,
                        size: this.formatFileSize(file.size),
                        date: new Date().toLocaleDateString('fa-IR'),
                        time: new Date().toLocaleTimeString('fa-IR'),
                        url: URL.createObjectURL(file),
                        uploadDate: new Date().toISOString()
                    };
                    
                    this.userData.pdfs.unshift(pdfData);
                    this.saveUserData();
                    this.loadPDFs();
                    
                    this.hideLoading();
                    this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'ÙØ§ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯');
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                    this.checkAchievements();
                    
                    // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡
                    this.addTreeExperience(10);
                } catch (error) {
                    this.hideLoading();
                    this.showNotification('Ø®Ø·Ø§', 'Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„');
                }
            }
            
            loadPDFs() {
                const pdfList = document.getElementById('pdfList');
                
                if (this.userData.pdfs.length === 0) {
                    pdfList.innerHTML = '<p style="text-align: center; padding: 20px; opacity: 0.5;">Ù‡ÛŒÚ† ÙØ§ÛŒÙ„ PDF Ø§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
                    return;
                }
                
                pdfList.innerHTML = '';
                
                this.userData.pdfs.forEach(pdf => {
                    const item = document.createElement('div');
                    item.className = 'file-item';
                    item.innerHTML = `
                        <div class="file-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="file-info">
                            <div class="file-name">${pdf.name}</div>
                            <div class="file-size">${pdf.size} â€¢ ${pdf.date} ${pdf.time}</div>
                        </div>
                        <button class="header-btn view-pdf" data-id="${pdf.id}" aria-label="Ù…Ø´Ø§Ù‡Ø¯Ù‡" title="Ù…Ø´Ø§Ù‡Ø¯Ù‡">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="header-btn delete-pdf" data-id="${pdf.id}" aria-label="Ø­Ø°Ù" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    pdfList.appendChild(item);
                });
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                document.querySelectorAll('.view-pdf').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const pdfId = parseInt(btn.dataset.id);
                        const pdf = this.userData.pdfs.find(p => p.id === pdfId);
                        if (pdf) {
                            window.open(pdf.url, '_blank');
                        }
                    });
                });
                
                document.querySelectorAll('.delete-pdf').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const pdfId = parseInt(btn.dataset.id);
                        if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
                            this.userData.pdfs = this.userData.pdfs.filter(p => p.id !== pdfId);
                            this.saveUserData();
                            this.loadPDFs();
                            this.showNotification('Ø­Ø°Ù', 'ÙØ§ÛŒÙ„ PDF Ø­Ø°Ù Ø´Ø¯');
                        }
                    });
                });
            }
            
            loadFlashcards() {
                const flashcardsList = document.getElementById('flashcardsList');
                
                if (this.userData.flashcards.length === 0) {
                    flashcardsList.innerHTML = '<p style="text-align: center; padding: 20px; opacity: 0.5;">Ù‡ÛŒÚ† ÙÙ„Ø´â€ŒÚ©Ø§Ø±ØªÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
                    return;
                }
                
                flashcardsList.innerHTML = '';
                
                this.userData.flashcards.forEach((card, index) => {
                    const item = document.createElement('div');
                    item.className = 'file-item';
                    item.style.cursor = 'pointer';
                    item.title = 'Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª';
                    item.innerHTML = `
                        <div class="file-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="file-info">
                            <div class="file-name">${card.question.substring(0, 40)}${card.question.length > 40 ? '...' : ''}</div>
                            <div class="file-size">${card.category || 'Ø¨Ø¯ÙˆÙ† Ø¯Ø³ØªÙ‡'} â€¢ ${card.date}</div>
                        </div>
                        <button class="header-btn delete-flashcard" data-id="${card.id}" aria-label="Ø­Ø°Ù" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    flashcardsList.appendChild(item);
                    
                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ø³Ø®
                    item.addEventListener('click', () => {
                        this.showFlashcardDetails(card);
                    });
                });
                
                // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø­Ø°Ù
                document.querySelectorAll('.delete-flashcard').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const cardId = parseInt(btn.dataset.id);
                        this.deleteFlashcard(cardId);
                    });
                });
            }
            
            showFlashcardDetails(card) {
                this.showNotification(card.category || 'ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª', `
                    Ø³ÙˆØ§Ù„: ${card.question}
                    
                    Ù¾Ø§Ø³Ø®: ${card.answer}
                    
                    ØªØ§Ø±ÛŒØ®: ${card.date}
                    Ø³Ø·Ø­: ${card.difficulty || 'Ù…ØªÙˆØ³Ø·'}
                `);
            }
            
            saveFlashcard() {
                const question = document.getElementById('flashcardQuestion').value.trim();
                const answer = document.getElementById('flashcardAnswer').value.trim();
                const category = document.getElementById('flashcardCategory').value.trim();
                const difficulty = document.getElementById('flashcardDifficulty').value;
                
                if (!question || !answer) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ Ø³ÙˆØ§Ù„ Ùˆ Ù¾Ø§Ø³Ø® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                const flashcard = {
                    id: Date.now(),
                    question,
                    answer,
                    category: category || 'Ø¨Ø¯ÙˆÙ† Ø¯Ø³ØªÙ‡',
                    difficulty,
                    date: new Date().toLocaleDateString('fa-IR'),
                    time: new Date().toLocaleTimeString('fa-IR'),
                    createdAt: new Date().toISOString()
                };
                
                this.userData.flashcards.unshift(flashcard);
                
                // Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ù…Ø±ÙˆØ±
                this.reviewManager.addCardForReview(flashcard);
                
                this.saveUserData();
                this.loadFlashcards();
                this.hideModal('flashcardModal');
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§
                document.getElementById('flashcardQuestion').value = '';
                document.getElementById('flashcardAnswer').value = '';
                document.getElementById('flashcardCategory').value = '';
                
                this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
                
                // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡
                this.addTreeExperience(5);
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                this.checkAchievements();
            }
            
            deleteFlashcard(cardId) {
                if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
                    this.userData.flashcards = this.userData.flashcards.filter(card => card.id !== cardId);
                    
                    // Ø­Ø°Ù Ø§Ø² Ø³ÛŒØ³ØªÙ… Ù…Ø±ÙˆØ±
                    this.reviewManager.removeCardFromReview(cardId);
                    
                    this.saveUserData();
                    this.loadFlashcards();
                    this.showNotification('Ø­Ø°Ù', 'ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø­Ø°Ù Ø´Ø¯');
                }
            }
            
            startFlashcardPractice() {
                if (this.userData.flashcards.length === 0) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù‡ÛŒÚ† ÙÙ„Ø´â€ŒÚ©Ø§Ø±ØªÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø±ÛŒÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    return;
                }
                
                this.showNotification('ØªÙ…Ø±ÛŒÙ† ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª', 'Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ØªÙ…Ø±ÛŒÙ†ØŒ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
            }
            
            loadNotes() {
                const notesList = document.getElementById('notesList');
                
                if (this.userData.notes.length === 0) {
                    notesList.innerHTML = '<p style="text-align: center; padding: 20px; opacity: 0.5;">Ù‡ÛŒÚ† ÛŒØ§Ø¯Ø¯Ø§Ø´ØªÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
                    return;
                }
                
                notesList.innerHTML = '';
                
                this.userData.notes.forEach((note, index) => {
                    const item = document.createElement('div');
                    item.className = 'file-item';
                    item.style.cursor = 'pointer';
                    item.title = 'Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª';
                    item.innerHTML = `
                        <div class="file-icon">
                            <i class="fas fa-sticky-note"></i>
                        </div>
                        <div class="file-info">
                            <div class="file-name">${note.title}</div>
                            <div class="file-size">${note.content.substring(0, 30)}${note.content.length > 30 ? '...' : ''}</div>
                        </div>
                        <button class="header-btn delete-note" data-id="${note.id}" aria-label="Ø­Ø°Ù" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    notesList.appendChild(item);
                    
                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª
                    item.addEventListener('click', () => {
                        this.showNoteDetails(note);
                    });
                });
                
                // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø­Ø°Ù
                document.querySelectorAll('.delete-note').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const noteId = parseInt(btn.dataset.id);
                        this.deleteNote(noteId);
                    });
                });
            }
            
            showNoteDetails(note) {
                this.showNotification(note.title, `
                    ${note.content}
                    
                    ØªØ§Ø±ÛŒØ®: ${note.date}
                    Ø²Ù…Ø§Ù†: ${note.time}
                    ${note.category ? `Ø¯Ø³ØªÙ‡: ${note.category}` : ''}
                `);
            }
            
            saveNote() {
                const title = document.getElementById('noteTitle').value.trim();
                const content = document.getElementById('noteContent').value.trim();
                const category = document.getElementById('noteCategory').value.trim();
                
                if (!title || !content) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù…Ø­ØªÙˆØ§ÛŒ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                const note = {
                    id: Date.now(),
                    title,
                    content,
                    category: category || 'Ø¨Ø¯ÙˆÙ† Ø¯Ø³ØªÙ‡',
                    date: new Date().toLocaleDateString('fa-IR'),
                    time: new Date().toLocaleTimeString('fa-IR'),
                    createdAt: new Date().toISOString()
                };
                
                this.userData.notes.unshift(note);
                this.saveUserData();
                this.loadNotes();
                this.hideModal('noteModal');
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§
                document.getElementById('noteTitle').value = '';
                document.getElementById('noteContent').value = '';
                document.getElementById('noteCategory').value = '';
                
                this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
                
                // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡
                this.addTreeExperience(3);
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                this.checkAchievements();
            }
            
            deleteNote(noteId) {
                if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
                    this.userData.notes = this.userData.notes.filter(note => note.id !== noteId);
                    this.saveUserData();
                    this.loadNotes();
                    this.showNotification('Ø­Ø°Ù', 'ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø­Ø°Ù Ø´Ø¯');
                }
            }
            
            searchNotes() {
                const query = prompt('Ø¹Ø¨Ø§Ø±Øª Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§:');
                if (!query) return;
                
                const results = this.userData.notes.filter(note => 
                    note.title.includes(query) || note.content.includes(query) || note.category.includes(query)
                );
                
                if (results.length === 0) {
                    this.showNotification('Ø¬Ø³ØªØ¬Ùˆ', `Ù‡ÛŒÚ† Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ "${query}" ÛŒØ§ÙØª Ù†Ø´Ø¯.`);
                } else {
                    this.showNotification('Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ', `${results.length} ÛŒØ§Ø¯Ø¯Ø§Ø´Øª ÛŒØ§ÙØª Ø´Ø¯. Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø±ÙˆÛŒ Ø¢Ù†Ù‡Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.`);
                }
            }
            
            updateReviewStats() {
                const stats = this.reviewManager.getStats();
                
                document.getElementById('cardsToReview').textContent = stats.cardsToReview;
                document.getElementById('cardsLearned').textContent = stats.cardsLearned;
                document.getElementById('reviewAccuracy').textContent = stats.accuracy;
                document.getElementById('nextReview').textContent = stats.nextReviewInHours;
            }
            
            startSmartReview() {
                this.reviewManager.startReviewSession();
            }
            
            showReviewAnswer() {
                document.getElementById('reviewAnswer').style.display = 'block';
                document.getElementById('showAnswerBtn').style.display = 'none';
                document.getElementById('reviewControls').style.display = 'block';
            }
            
            rateReviewCard(rating) {
                this.reviewManager.rateCurrentCard(rating);
            }
            
            saveProfile() {
                const name = document.getElementById('userName').value.trim();
                const email = document.getElementById('userEmail').value.trim();
                const dailyGoal = parseInt(document.getElementById('dailyGoal').value);
                
                if (!name) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                if (email && !this.validateEmail(email)) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                if (dailyGoal < 15 || dailyGoal > 600) {
                    this.showNotification('Ø®Ø·Ø§', 'Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û±Ûµ ØªØ§ Û¶Û°Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø§Ø´Ø¯');
                    return;
                }
                
                this.userData.name = name;
                this.userData.email = email;
                this.userData.dailyGoal = dailyGoal;
                this.saveUserData();
                this.updateUI();
                this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
            }
            
            validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
            
            showBackupModal() {
                const backupData = {
                    version: '3.0.0',
                    timestamp: new Date().toISOString(),
                    data: this.userData
                };
                
                const backupString = JSON.stringify(backupData, null, 2);
                document.getElementById('backupDataText').value = backupString;
                this.showModal('backupModal');
            }
            
            copyBackup() {
                const textarea = document.getElementById('backupDataText');
                textarea.select();
                textarea.setSelectionRange(0, 99999);
                
                try {
                    navigator.clipboard.writeText(textarea.value).then(() => {
                        this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ù¾ÛŒ Ø´Ø¯');
                    });
                } catch (error) {
                    document.execCommand('copy');
                    this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ù¾ÛŒ Ø´Ø¯');
                }
            }
            
            downloadBackup() {
                const backupData = {
                    version: '3.0.0',
                    timestamp: new Date().toISOString(),
                    data: this.userData
                };
                
                const backupString = JSON.stringify(backupData, null, 2);
                const blob = new Blob([backupString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `mstudy_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ', 'ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯');
            }
            
            restoreData() {
                const fileInput = document.getElementById('restoreFileInput');
                const textarea = document.getElementById('restoreDataText');
                
                let backupString = '';
                
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        backupString = e.target.result;
                        this.processRestore(backupString);
                    };
                    
                    reader.readAsText(file);
                } else if (textarea.value.trim()) {
                    backupString = textarea.value.trim();
                    this.processRestore(backupString);
                } else {
                    this.showNotification('Ø®Ø·Ø§', 'Ù„Ø·ÙØ§Ù‹ ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ú©Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }
            }
            
            processRestore(backupString) {
                try {
                    const backupData = JSON.parse(backupString);
                    
                    if (!backupData.version || !backupData.data) {
                        throw new Error('ÙØ±Ù…Øª ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
                    }
                    
                    if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ú©Ù†ÛŒØ¯ØŸ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø´Ø¯.')) {
                        this.userData = backupData.data;
                        this.saveUserData();
                        this.hideModal('restoreModal');
                        this.showNotification('Ù…ÙˆÙÙ‚ÛŒØª', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯Ù†Ø¯');
                        setTimeout(() => location.reload(), 1500);
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ:', error);
                    this.showNotification('Ø®Ø·Ø§', 'ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
                }
            }
            
            exportData() {
                const exportData = {
                    stats: this.userData.stats,
                    achievements: this.userData.achievements,
                    tree: this.userData.tree,
                    flashcards: this.userData.flashcards.map(card => ({
                        question: card.question,
                        answer: card.answer,
                        category: card.category
                    })),
                    notes: this.userData.notes.map(note => ({
                        title: note.title,
                        content: note.content,
                        date: note.date
                    }))
                };
                
                const exportString = JSON.stringify(exportData, null, 2);
                const blob = new Blob([exportString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `mstudy_export_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Ø®Ø±ÙˆØ¬ÛŒ', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯Ù†Ø¯');
            }
            
            resetUserData() {
                if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ Ø¨Ø±Ú¯Ø´Øªâ€ŒÙ†Ø§Ù¾Ø°ÛŒØ± Ø§Ø³Øª.')) {
                    this.userData = this.getDefaultUserData();
                    localStorage.removeItem('mstudy_data');
                    sessionStorage.removeItem('mstudy_backup');
                    this.updateUI();
                    this.showNotification('ØªÙˆØ¬Ù‡', 'Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯. Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÛŒâ€ŒÙ„ÙˆØ¯ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.');
                    setTimeout(() => location.reload(), 1500);
                }
            }
            
            showModal(modalId) {
                document.getElementById(modalId).classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            hideModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
                document.body.style.overflow = '';
            }
            
            closeAllModals() {
                document.querySelectorAll('.modal.active').forEach(modal => {
                    modal.classList.remove('active');
                });
                document.body.style.overflow = '';
            }
            
            showLoading(text = 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...') {
                document.getElementById('loadingText').textContent = text;
                document.getElementById('loadingModal').classList.add('active');
            }
            
            hideLoading() {
                document.getElementById('loadingModal').classList.remove('active');
            }
            
            showNotification(title, message) {
                const toast = document.getElementById('notificationToast');
                document.getElementById('notificationTitle').textContent = title;
                document.getElementById('notificationMessage').textContent = message;
                
                toast.classList.add('show');
                
                // Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† - Ø­Ø°Ù Ø´Ø¯
                
                // ÙˆÛŒØ¨Ø±ÛŒØ´Ù†
                if (this.userData.settings.notificationVibration && 'vibrate' in navigator) {
                    navigator.vibrate(100);
                }
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
            
            updateUI() {
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±
                if (this.userData.name) {
                    document.getElementById('userName').value = this.userData.name;
                }
                
                if (this.userData.email) {
                    document.getElementById('userEmail').value = this.userData.email;
                }
                
                document.getElementById('dailyGoal').value = this.userData.dailyGoal;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±
                document.getElementById('todayTime').textContent = this.userData.stats.todayStudyTime;
                document.getElementById('streakDays').textContent = this.userData.stats.streakDays;
                document.getElementById('totalSessions').textContent = this.userData.stats.totalSessions;
                document.getElementById('totalHours').textContent = this.userData.stats.totalHours;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                document.getElementById('autoSync').checked = this.userData.settings.autoSync;
                document.getElementById('darkModeSwitch').checked = this.userData.settings.darkMode;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø±Ø®Øª
                this.updateTreeUI();
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§
                this.loadAchievements();
            }
            
            updateStatsUI() {
                document.getElementById('avgStudyTime').textContent = Math.round(this.userData.stats.todayStudyTime / 60) || 0;
                document.getElementById('bestDay').textContent = this.userData.stats.bestDay;
                document.getElementById('focusScore').textContent = `${this.userData.stats.focusScore}%`;
                document.getElementById('consistency').textContent = `${this.userData.stats.consistency}%`;
            }
            
            showDetailedStats() {
                const stats = `
                    ğŸ“Š Ø¢Ù…Ø§Ø± Ú©Ø§Ù…Ù„ Ù…Ø·Ø§Ù„Ø¹Ù‡:
                    
                    Ú©Ù„ Ø³Ø§Ø¹Ø§Øª Ù…Ø·Ø§Ù„Ø¹Ù‡: ${this.userData.stats.totalHours} Ø³Ø§Ø¹Øª
                    Ø¬Ù„Ø³Ø§Øª Ù…Ø·Ø§Ù„Ø¹Ù‡: ${this.userData.stats.totalSessions} Ø¬Ù„Ø³Ù‡
                    Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ: ${this.userData.stats.streakDays} Ø±ÙˆØ²
                    Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ²: ${this.userData.stats.bestDay} Ø¯Ù‚ÛŒÙ‚Ù‡
                    
                    Ø§Ù…Ø±ÙˆØ²: ${this.userData.stats.todayStudyTime} Ø¯Ù‚ÛŒÙ‚Ù‡
                    Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡: ${this.userData.dailyGoal} Ø¯Ù‚ÛŒÙ‚Ù‡
                    Ù¾ÛŒØ´Ø±ÙØª: ${Math.round((this.userData.stats.todayStudyTime / this.userData.dailyGoal) * 100)}%
                    
                    Ø§Ù…ØªÛŒØ§Ø² ØªÙ…Ø±Ú©Ø²: ${this.userData.stats.focusScore}%
                    Ù…ÛŒØ²Ø§Ù† ØªØ¯Ø§ÙˆÙ…: ${this.userData.stats.consistency}%
                    
                    Ø³Ø·Ø­ Ø¯Ø±Ø®Øª: ${this.userData.tree.level}
                    ØªØ¬Ø±Ø¨Ù‡: ${this.userData.tree.experience}/${this.userData.tree.maxExperience}
                    
                    Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§: ${this.userData.achievements.length} Ø§Ø² Û±Û¹
                `;
                
                this.showNotification('Ø¢Ù…Ø§Ø± Ú©Ø§Ù…Ù„', stats);
            }
            
            showLibraryStats() {
                const stats = `
                    ğŸ“š Ø¢Ù…Ø§Ø± Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡:
                    
                    PDF Ù‡Ø§: ${this.userData.pdfs.length} ÙØ§ÛŒÙ„
                    ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§: ${this.userData.flashcards.length} Ú©Ø§Ø±Øª
                    ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§: ${this.userData.notes.length} ÛŒØ§Ø¯Ø¯Ø§Ø´Øª
                    
                    Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯:
                    Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±: ${this.reviewManager.getStats().cardsToReview}
                    Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÛŒØ§Ø¯ Ú¯Ø±ÙØªÙ‡: ${this.reviewManager.getStats().cardsLearned}
                    Ø¯Ù‚Øª Ù…Ø±ÙˆØ±: ${this.reviewManager.getStats().accuracy}
                `;
                
                this.showNotification('Ø¢Ù…Ø§Ø± Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡', stats);
            }
            
            saveSoundMix() {
                this.showNotification('ØµØ¯Ø§Ù‡Ø§', 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…ÛŒÚ©Ø³Ø± Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.');
            } // Ø§ÛŒÙ† Ù…ØªØ¯ Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯Ù‡ Ø§Ù…Ø§ Ø¯ÛŒÚ¯Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ù‚Ø§Ø¨Ù„ Ø­Ø°Ù Ø§Ø³Øª)
            
            formatFileSize(bytes) {
                if (bytes < 1024) return bytes + ' Ø¨Ø§ÛŒØª';
                if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' Ú©ÛŒÙ„ÙˆØ¨Ø§ÛŒØª';
                return (bytes / (1024 * 1024)).toFixed(1) + ' Ù…Ú¯Ø§Ø¨Ø§ÛŒØª';
            }
            
            checkPermissions() {
                // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…Ø¬ÙˆØ² Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
                if ('Notification' in window && Notification.permission === 'default') {
                    setTimeout(() => {
                        Notification.requestPermission().then(permission => {
                            if (permission === 'granted') {
                                this.userData.settings.notificationsEnabled = true;
                                this.saveUserData();
                            }
                        });
                    }, 3000);
                }
            }
            
            startMonitoring() {
                // Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø­Ø§ÙØ¸Ù‡
                setInterval(() => {
                    this.storage.updateStorageInfo();
                }, 30000);
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±
                setInterval(() => {
                    this.storage.autoSave();
                }, 30000);
                
                // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ
                setInterval(() => {
                    if (this.userData.settings.autoSync) {
                        this.syncData();
                    }
                }, 5 * 60 * 1000); // Ù‡Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡
            }
        }
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        // ============================================
        class EnhancedStorage {
            constructor(app) {
                this.app = app;
                this.STORAGE_KEY = 'mstudy_pro_data_v3';
                this.BACKUP_KEY = 'mstudy_backup_v3';
                this.CLOUD_KEY = 'mstudy_cloud_v3';
                this.lastSaveTime = 0;
                this.saveInterval = 30000; // Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
            }
            
            async load() {
                try {
                    // Ø§ÙˆÙ„ÙˆÛŒØª 1: localStorage Ø§ØµÙ„ÛŒ
                    let data = localStorage.getItem(this.STORAGE_KEY);
                    if (data) {
                        return this.decryptData(JSON.parse(data));
                    }
                    
                    // Ø§ÙˆÙ„ÙˆÛŒØª 2: backup Ø¯Ø± localStorage
                    data = localStorage.getItem(this.BACKUP_KEY);
                    if (data) {
                        console.log('Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù†Ø³Ø®Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†');
                        return this.decryptData(JSON.parse(data));
                    }
                    
                    // Ø§ÙˆÙ„ÙˆÛŒØª 3: sessionStorage
                    data = sessionStorage.getItem(this.STORAGE_KEY);
                    if (data) {
                        console.log('Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² sessionStorage');
                        return this.decryptData(JSON.parse(data));
                    }
                    
                    return null;
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', error);
                    return null;
                }
            }
            
            async save(data) {
                try {
                    const now = Date.now();
                    
                    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯
                    if (now - this.lastSaveTime < 5000) { // Ù‡Ø± 5 Ø«Ø§Ù†ÛŒÙ‡
                        return;
                    }
                    
                    this.lastSaveTime = now;
                    
                    // Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    const encryptedData = this.encryptData(data);
                    
                    // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(encryptedData));
                    
                    // Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
                    this.createBackup(encryptedData);
                    
                    // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± sessionStorage
                    sessionStorage.setItem(this.STORAGE_KEY, JSON.stringify(encryptedData));
                    
                    console.log('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯');
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', error);
                    this.emergencySave(data);
                }
            }
            
            encryptData(data) {
                if (!this.app.userData.settings.encryption) {
                    return data;
                }
                
                try {
                    // Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ø¨ÛŒØ´ØªØ±
                    const dataStr = JSON.stringify(data);
                    const key = this.getEncryptionKey();
                    let encrypted = '';
                    
                    for (let i = 0; i < dataStr.length; i++) {
                        const charCode = dataStr.charCodeAt(i) ^ key.charCodeAt(i % key.length);
                        encrypted += String.fromCharCode(charCode);
                    }
                    
                    return btoa(encrypted);
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ:', error);
                    return data;
                }
            }
            
            decryptData(encryptedData) {
                if (typeof encryptedData !== 'string' || !this.app.userData.settings.encryption) {
                    return encryptedData;
                }
                
                try {
                    const key = this.getEncryptionKey();
                    const decoded = atob(encryptedData);
                    let decrypted = '';
                    
                    for (let i = 0; i < decoded.length; i++) {
                        const charCode = decoded.charCodeAt(i) ^ key.charCodeAt(i % key.length);
                        decrypted += String.fromCharCode(charCode);
                    }
                    
                    return JSON.parse(decrypted);
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø±Ù…Ø²Ú¯Ø´Ø§ÛŒÛŒ:', error);
                    return encryptedData;
                }
            }
            
            getEncryptionKey() {
                return 'mstudy_pro_secret_key_2024_v3_' + (navigator.userAgent || 'default');
            }
            
            createBackup(data) {
                try {
                    // Ø°Ø®ÛŒØ±Ù‡ 3 Ù†Ø³Ø®Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
                    const backups = JSON.parse(localStorage.getItem(this.BACKUP_KEY + '_history') || '[]');
                    
                    backups.unshift({
                        data: data,
                        timestamp: new Date().toISOString(),
                        size: JSON.stringify(data).length
                    });
                    
                    // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨Ù‡ 3 Ù†Ø³Ø®Ù‡
                    if (backups.length > 3) {
                        backups.pop();
                    }
                    
                    localStorage.setItem(this.BACKUP_KEY + '_history', JSON.stringify(backups));
                    
                    // Ø°Ø®ÛŒØ±Ù‡ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡
                    localStorage.setItem(this.BACKUP_KEY, JSON.stringify(data));
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†:', error);
                }
            }
            
            emergencySave(data) {
                try {
                    // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ Ø¯Ø± sessionStorage
                    const simpleData = {
                        name: data.name,
                        stats: data.stats,
                        tree: data.tree,
                        achievements: data.achievements,
                        lastSync: new Date().toISOString()
                    };
                    
                    sessionStorage.setItem('mstudy_emergency', JSON.stringify(simpleData));
                    console.log('Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ:', error);
                }
            }
            
            initialSave() {
                setTimeout(() => {
                    this.save(this.app.userData);
                }, 1000);
            }
            
            autoSave() {
                this.save(this.app.userData);
            }
            
            async syncToCloud() {
                // Ø¯Ø± Ù†Ø³Ø®Ù‡ ÙˆØ¨ØŒ Ø§Ø² localStorage Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                // Ø¯Ø± Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¨Ø§ Ø³Ø±ÙˆØ± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ú©Ø±Ø¯
                console.log('Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ ÙØ¶Ø§ÛŒ Ø§Ø¨Ø±ÛŒ (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ)');
                return true;
            }
            
            updateStorageInfo() {
                try {
                    const total = 5 * 1024 * 1024; // 5MB
                    let used = 0;
                    
                    // Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ¶Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key.startsWith('mstudy')) {
                            used += localStorage.getItem(key).length;
                        }
                    }
                    
                    const percent = Math.min(100, (used / total) * 100);
                    
                    document.getElementById('storageUsage').style.width = `${percent}%`;
                    document.getElementById('storageUsed').textContent = this.formatBytes(used);
                    document.getElementById('storageTotal').textContent = '5';
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ¶Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ:', error);
                }
            }
            
            formatBytes(bytes) {
                if (bytes < 1024) return bytes + ' Ø¨Ø§ÛŒØª';
                if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' Ú©ÛŒÙ„ÙˆØ¨Ø§ÛŒØª';
                return (bytes / (1024 * 1024)).toFixed(1) + ' Ù…Ú¯Ø§Ø¨Ø§ÛŒØª';
            }
        }
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª ØµØ¯Ø§Ù‡Ø§ â€“ Ø­Ø°Ù Ú©Ø§Ù…Ù„
        // ============================================
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯
        // ============================================
        class ReviewManager {
            constructor(app) {
                this.app = app;
                this.currentSession = null;
                this.currentCardIndex = 0;
                this.sessionCards = [];
                this.reviewStats = {
                    total: 0,
                    correct: 0,
                    startTime: null
                };
            }
            
            initialize() {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±ÙˆØ± Ø§Ø² ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§
                this.loadReviewCards();
            }
            
            loadReviewCards() {
                this.app.userData.reviews.cards = [];
                
                this.app.userData.flashcards.forEach(card => {
                    this.addCardForReview(card);
                });
            }
            
            addCardForReview(card) {
                const existingCard = this.app.userData.reviews.cards.find(c => c.cardId === card.id);
                
                if (!existingCard) {
                    this.app.userData.reviews.cards.push({
                        cardId: card.id,
                        question: card.question,
                        answer: card.answer,
                        category: card.category,
                        difficulty: card.difficulty || 'medium',
                        nextReview: new Date().toISOString(), // Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±
                        interval: 1, // Ø±ÙˆØ²
                        easeFactor: 2.5,
                        reviews: 0,
                        correctReviews: 0,
                        lastReview: null,
                        createdAt: new Date().toISOString()
                    });
                    
                    this.app.saveUserData();
                }
            }
            
            removeCardFromReview(cardId) {
                this.app.userData.reviews.cards = this.app.userData.reviews.cards.filter(c => c.cardId !== cardId);
                this.app.saveUserData();
            }
            
            getStats() {
                const now = new Date();
                const cardsToReview = this.app.userData.reviews.cards.filter(card => {
                    return new Date(card.nextReview) <= now;
                }).length;
                
                const cardsLearned = this.app.userData.reviews.cards.filter(card => card.reviews > 0).length;
                
                const totalReviews = this.app.userData.reviews.stats.totalReviews || 0;
                const correctReviews = this.app.userData.reviews.stats.correctReviews || 0;
                const accuracy = totalReviews > 0 ? Math.round((correctReviews / totalReviews) * 100) : 0;
                
                // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ
                let nextReviewInHours = 24;
                const upcomingReviews = this.app.userData.reviews.cards
                    .map(card => new Date(card.nextReview))
                    .filter(date => date > now)
                    .sort((a, b) => a - b);
                
                if (upcomingReviews.length > 0) {
                    nextReviewInHours = Math.round((upcomingReviews[0] - now) / (1000 * 60 * 60));
                }
                
                return {
                    cardsToReview,
                    cardsLearned,
                    accuracy: accuracy + '%',
                    nextReviewInHours
                };
            }
            
            startReviewSession() {
                const cardsToReview = this.app.userData.reviews.cards.filter(card => {
                    return new Date(card.nextReview) <= new Date();
                });
                
                if (cardsToReview.length === 0) {
                    this.app.showNotification('Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯', 'Ù‡ÛŒÚ† Ú©Ø§Ø±ØªÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                    return;
                }
                
                this.currentSession = {
                    id: Date.now(),
                    startTime: new Date().toISOString(),
                    cards: cardsToReview,
                    currentIndex: 0,
                    stats: {
                        total: cardsToReview.length,
                        correct: 0
                    }
                };
                
                this.currentCardIndex = 0;
                this.sessionCards = cardsToReview;
                this.reviewStats = {
                    total: 0,
                    correct: 0,
                    startTime: new Date()
                };
                
                this.showNextCard();
                this.app.showModal('reviewModal');
            }
            
            showNextCard() {
                if (this.currentCardIndex >= this.sessionCards.length) {
                    this.endReviewSession();
                    return;
                }
                
                const card = this.sessionCards[this.currentCardIndex];
                
                document.getElementById('reviewQuestion').textContent = card.question;
                document.getElementById('reviewAnswer').textContent = card.answer;
                document.getElementById('reviewAnswer').style.display = 'none';
                document.getElementById('showAnswerBtn').style.display = 'block';
                document.getElementById('reviewControls').style.display = 'none';
                
                document.getElementById('reviewProgress').textContent = this.sessionCards.length - this.currentCardIndex;
                document.getElementById('reviewCorrect').textContent = this.reviewStats.correct;
            }
            
            showReviewAnswer() {
                document.getElementById('reviewAnswer').style.display = 'block';
                document.getElementById('showAnswerBtn').style.display = 'none';
                document.getElementById('reviewControls').style.display = 'block';
            }
            
            rateCurrentCard(rating) {
                const card = this.sessionCards[this.currentCardIndex];
                const reviewCard = this.app.userData.reviews.cards.find(c => c.cardId === card.cardId);
                
                if (!reviewCard) return;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± Ù…Ø±ÙˆØ±
                reviewCard.reviews++;
                reviewCard.lastReview = new Date().toISOString();
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ SM-2 algorithm
                let easeFactor = reviewCard.easeFactor;
                let interval = reviewCard.interval;
                
                switch(rating) {
                    case 'again':
                        interval = 1;
                        easeFactor = Math.max(1.3, easeFactor - 0.2);
                        break;
                    case 'hard':
                        interval = Math.max(1, interval * 0.8);
                        easeFactor = Math.max(1.3, easeFactor - 0.15);
                        break;
                    case 'good':
                        interval = Math.ceil(interval * easeFactor);
                        easeFactor = easeFactor + 0.1;
                        break;
                    case 'easy':
                        interval = Math.ceil(interval * easeFactor * 1.3);
                        easeFactor = easeFactor + 0.15;
                        break;
                }
                
                // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ease factor
                easeFactor = Math.max(1.3, Math.min(2.5, easeFactor));
                
                reviewCard.interval = interval;
                reviewCard.easeFactor = easeFactor;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ§Ø±ÛŒØ® Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ
                const nextReview = new Date();
                nextReview.setDate(nextReview.getDate() + interval);
                reviewCard.nextReview = nextReview.toISOString();
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± Ø¬Ù„Ø³Ù‡
                this.reviewStats.total++;
                if (rating === 'good' || rating === 'easy') {
                    reviewCard.correctReviews++;
                    this.reviewStats.correct++;
                }
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ
                this.app.userData.reviews.stats.totalReviews = (this.app.userData.reviews.stats.totalReviews || 0) + 1;
                if (rating === 'good' || rating === 'easy') {
                    this.app.userData.reviews.stats.correctReviews = (this.app.userData.reviews.stats.correctReviews || 0) + 1;
                }
                this.app.userData.reviews.stats.lastReviewDate = new Date().toISOString();
                
                // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡
                this.app.addTreeExperience(2);
                
                // Ø±ÙØªÙ† Ø¨Ù‡ Ú©Ø§Ø±Øª Ø¨Ø¹Ø¯ÛŒ
                this.currentCardIndex++;
                
                if (this.currentCardIndex < this.sessionCards.length) {
                    setTimeout(() => {
                        this.showNextCard();
                    }, 500);
                } else {
                    setTimeout(() => {
                        this.endReviewSession();
                    }, 1000);
                }
                
                this.app.saveUserData();
                this.app.updateReviewStats();
            }
            
            endReviewSession() {
                const accuracy = this.reviewStats.total > 0 ? 
                    Math.round((this.reviewStats.correct / this.reviewStats.total) * 100) : 0;
                
                const duration = Math.round((new Date() - this.reviewStats.startTime) / 1000);
                
                this.app.showNotification('Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯', 
                    `Ø¬Ù„Ø³Ù‡ Ù…Ø±ÙˆØ± Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯!
                    
                    Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±ÙˆØ± Ø´Ø¯Ù‡: ${this.reviewStats.total}
                    Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ ØµØ­ÛŒØ­: ${this.reviewStats.correct}
                    Ø¯Ù‚Øª: ${accuracy}%
                    Ù…Ø¯Øª Ø²Ù…Ø§Ù†: ${duration} Ø«Ø§Ù†ÛŒÙ‡
                    
                    ØªØ¬Ø±Ø¨Ù‡ Ú©Ø³Ø¨ Ø´Ø¯Ù‡: ${this.reviewStats.total * 2}`);
                
                this.app.hideModal('reviewModal');
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                this.app.checkAchievements();
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ú†Ø§Ù„Ø´
                this.app.challengeManager.updateChallengeProgress('review', this.reviewStats.total);
            }
        }
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§
        // ============================================
        class ChallengeManager {
            constructor(app) {
                this.app = app;
                this.dailyChallenges = [
                    { id: 'study_60', type: 'study_time', target: 60, description: 'Û¶Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ù†', reward: 50 },
                    { id: 'three_sessions', type: 'sessions', target: 3, description: 'Û³ Ø¬Ù„Ø³Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´', reward: 75 },
                    { id: 'complete_goal', type: 'goal', target: 100, description: 'Ø¨Ù‡ Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ø±Ø³', reward: 100 },
                    { id: 'review_10', type: 'review', target: 10, description: 'Û±Û° ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ù…Ø±ÙˆØ± Ú©Ù†', reward: 60 },
                    { id: 'water_8', type: 'water', target: 8, description: 'Û¸ Ù„ÛŒÙˆØ§Ù† Ø¢Ø¨ Ø¨Ù†ÙˆØ´', reward: 40 }
                ];
            }
            
            initialize() {
                // Ø§Ù†ØªØ®Ø§Ø¨ Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡
                this.selectDailyChallenge();
            }
            
            selectDailyChallenge() {
                const today = new Date().toISOString().split('T')[0];
                
                // Ø§Ú¯Ø± Ú†Ø§Ù„Ø´ Ø§Ù…Ø±ÙˆØ² ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ØŒ Ø§Ø² Ø¢Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
                if (this.app.userData.challenges.daily && 
                    this.app.userData.challenges.daily.date === today) {
                    return;
                }
                
                // Ø§Ù†ØªØ®Ø§Ø¨ Ú†Ø§Ù„Ø´ ØªØµØ§Ø¯ÙÛŒ
                const randomIndex = Math.floor(Math.random() * this.dailyChallenges.length);
                const challenge = this.dailyChallenges[randomIndex];
                
                this.app.userData.challenges.daily = {
                    ...challenge,
                    date: today,
                    progress: 0,
                    completed: false
                };
                
                this.app.saveUserData();
            }
            
            showDailyChallenge() {
                const challenge = this.app.userData.challenges.daily;
                if (!challenge) return;
                
                const challengeCard = document.getElementById('dailyChallengeCard');
                const challengeText = document.getElementById('challengeText');
                const challengeProgress = document.getElementById('challengeProgress');
                const challengeProgressText = document.getElementById('challengeProgressText');
                const challengeReward = document.getElementById('challengeReward');
                
                if (challenge.completed) {
                    challengeCard.style.display = 'none';
                    return;
                }
                
                challengeCard.style.display = 'block';
                challengeText.textContent = challenge.description;
                challengeReward.textContent = `+${challenge.reward}`;
                
                const progress = Math.min(100, (challenge.progress / challenge.target) * 100);
                challengeProgress.style.width = `${progress}%`;
                challengeProgressText.textContent = `Ù¾ÛŒØ´Ø±ÙØª: ${Math.round(progress)}%`;
            }
            
            updateChallengeProgress(type, amount) {
                const challenge = this.app.userData.challenges.daily;
                if (!challenge || challenge.completed || challenge.type !== type) return;
                
                challenge.progress += amount;
                
                if (challenge.progress >= challenge.target) {
                    challenge.completed = true;
                    this.completeChallenge();
                }
                
                this.app.saveUserData();
                this.updateChallengeUI();
            }
            
            updateChallengeUI() {
                const challenge = this.app.userData.challenges.daily;
                if (!challenge) return;
                
                const challengeProgress = document.getElementById('challengeProgress');
                const challengeProgressText = document.getElementById('challengeProgressText');
                
                const progress = Math.min(100, (challenge.progress / challenge.target) * 100);
                if (challengeProgress) {
                    challengeProgress.style.width = `${progress}%`;
                }
                if (challengeProgressText) {
                    challengeProgressText.textContent = `Ù¾ÛŒØ´Ø±ÙØª: ${Math.round(progress)}%`;
                }
                
                if (challenge.completed) {
                    document.getElementById('dailyChallengeCard').style.display = 'none';
                }
            }
            
            completeChallenge() {
                const challenge = this.app.userData.challenges.daily;
                if (!challenge || !challenge.completed) return;
                
                // Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ø§Ø¯Ø§Ø´
                this.app.addTreeExperience(challenge.reward);
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± Ú†Ø§Ù„Ø´
                this.app.userData.challenges.completed.push(challenge.id);
                this.app.userData.challenges.streak++;
                this.app.userData.challenges.lastCompleted = new Date().toISOString();
                
                // Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ù„Ø§Ù†
                this.app.showNotification('ğŸ‰ Ú†Ø§Ù„Ø´ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!', 
                    `ØªØ¨Ø±ÛŒÚ©! Ú†Ø§Ù„Ø´ "${challenge.description}" Ø±Ø§ Ú©Ø§Ù…Ù„ Ú©Ø±Ø¯ÛŒØ¯.
                    
                    Ù¾Ø§Ø¯Ø§Ø´: ${challenge.reward} ØªØ¬Ø±Ø¨Ù‡
                    ØªØ¬Ø±Ø¨Ù‡ Ú©Ù„ Ø¯Ø±Ø®Øª: ${challenge.reward} Ù†Ù‚Ø·Ù‡
                    
                    Ú†Ø§Ù„Ø´ Ø¨Ø¹Ø¯ÛŒ ÙØ±Ø¯Ø§!`);
                
                // Ù¾Ø®Ø´ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
                this.app.saveUserData();
            }
        }
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ù„Ø§Ù…Øª
        // ============================================
        class HealthManager {
            constructor(app) {
                this.app = app;
                this.eyeBreakInterval = null;
                this.stretchBreakInterval = null;
                this.waterCount = 0;
                this.lastWaterTime = null;
            }
            
            initialize() {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù„Ø§Ù…Øª
                this.loadHealthData();
                
                // Ø´Ø±ÙˆØ¹ ØªØ§ÛŒÙ…Ø±Ù‡Ø§ÛŒ Ø³Ù„Ø§Ù…Øª
                this.startHealthTimers();
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                this.updateHealthUI();
            }
            
            loadHealthData() {
                if (this.app.userData.health) {
                    this.waterCount = this.app.userData.tree.waterCount || 0;
                    this.lastWaterTime = this.app.userData.tree.lastWaterTime;
                }
            }
            
            startHealthTimers() {
                // ØªØ§ÛŒÙ…Ø± Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…
                if (this.app.userData.settings.eyeBreak) {
                    this.startEyeBreakTimer();
                }
                
                // ØªØ§ÛŒÙ…Ø± Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ
                if (this.app.userData.settings.stretchBreak) {
                    this.startStretchBreakTimer();
                }
            }
            
            startEyeBreakTimer() {
                if (this.eyeBreakInterval) clearInterval(this.eyeBreakInterval);
                
                this.eyeBreakInterval = setInterval(() => {
                    this.updateEyeBreakTimer();
                }, 1000);
            }
            
            startStretchBreakTimer() {
                if (this.stretchBreakInterval) clearInterval(this.stretchBreakInterval);
                
                this.stretchBreakInterval = setInterval(() => {
                    this.updateStretchBreakTimer();
                }, 1000);
            }
            
            updateEyeBreakTimer() {
                const lastBreak = this.app.userData.health.lastEyeBreak ? 
                    new Date(this.app.userData.health.lastEyeBreak) : new Date(0);
                const now = new Date();
                const diffMs = now - lastBreak;
                const diffMins = Math.floor(diffMs / 60000);
                
                const remaining = 20 - (diffMins % 20);
                const display = `${remaining.toString().padStart(2, '0')}:00`;
                
                document.getElementById('eyeRestTimer').textContent = display;
            }
            
            updateStretchBreakTimer() {
                const lastBreak = this.app.userData.health.lastStretchBreak ? 
                    new Date(this.app.userData.health.lastStretchBreak) : new Date(0);
                const now = new Date();
                const diffMs = now - lastBreak;
                const diffMins = Math.floor(diffMs / 60000);
                
                const remaining = 60 - (diffMins % 60);
                const display = `${remaining.toString().padStart(2, '0')}:00`;
                
                document.getElementById('stretchTimer').textContent = display;
            }
            
            updateHealthUI() {
                document.getElementById('hydrationCount').textContent = this.waterCount;
                document.getElementById('postureScore').textContent = `${this.app.userData.tree.postureScore || 100}%`;
                
                this.updateEyeBreakTimer();
                this.updateStretchBreakTimer();
            }
            
            takeEyeBreak() {
                this.app.userData.health.lastEyeBreak = new Date().toISOString();
                this.app.saveUserData();
                
                this.app.showNotification('Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…', 
                    `Ø¨Ø±Ø§ÛŒ Û²Û° Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ù‡ Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒ Ø¯ÙˆØ± Ù†Ú¯Ø§Ù‡ Ú©Ù†ÛŒØ¯.
                    
                    ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§:
                    Û±. Ø§Ø² ØµÙØ­Ù‡ ÙØ§ØµÙ„Ù‡ Ø¨Ú¯ÛŒØ±ÛŒØ¯
                    Û². Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ Ø¯ÙˆØ± Ù†Ú¯Ø§Ù‡ Ú©Ù†ÛŒØ¯
                    Û³. Ù¾Ù„Ú© Ø¨Ø²Ù†ÛŒØ¯
                    Û´. ØªÙ…Ø±ÛŒÙ† Û²Û°-Û²Û°-Û²Û°: Ù‡Ø± Û²Û° Ø¯Ù‚ÛŒÙ‚Ù‡ØŒ Û²Û° Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ù‡ Û²Û° ÙÙˆØª (Û¶ Ù…ØªØ±) Ø¯ÙˆØ±ØªØ± Ù†Ú¯Ø§Ù‡ Ú©Ù†ÛŒØ¯`);
                
                // Ù¾Ø®Ø´ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
                
                // Ø´Ù…Ø§Ø±Ø´ Ù…Ø¹Ú©ÙˆØ³
                let seconds = 20;
                const interval = setInterval(() => {
                    this.app.showNotification('Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…', `${seconds} Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡...`);
                    seconds--;
                    
                    if (seconds <= 0) {
                        clearInterval(interval);
                        this.app.showNotification('Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…', 'Ø§Ø³ØªØ±Ø§Ø­Øª ØªÙ…Ø§Ù… Ø´Ø¯! Ø¨Ø±Ú¯Ø±Ø¯ÛŒØ¯ Ø¨Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡.');
                    }
                }, 1000);
            }
            
            takeStretchBreak() {
                this.app.userData.health.lastStretchBreak = new Date().toISOString();
                this.app.saveUserData();
                
                this.app.showNotification('Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ', 
                    `Ø¨Ø±Ø§ÛŒ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø­Ø±Ú©Ø§Øª Ú©Ø´Ø´ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.
                    
                    ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:
                    Û±. Ú©Ø´Ø´ Ú¯Ø±Ø¯Ù†
                    Û². Ú†Ø±Ø®Ø´ Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§
                    Û³. Ú©Ø´Ø´ Ù¾Ø´Øª
                    Û´. Ø­Ø±Ú©Øª Ù…Ú† Ø¯Ø³Øª
                    Ûµ. Ø¨Ù„Ù†Ø¯ Ø´Ø¯Ù† Ùˆ Ù‚Ø¯Ù… Ø²Ø¯Ù†`);
                
                // Ù¾Ø®Ø´ ØµØ¯Ø§ Ø­Ø°Ù Ø´Ø¯
            }
            
            logWater() {
                this.waterCount++;
                this.app.userData.tree.waterCount = this.waterCount;
                this.app.userData.tree.lastWaterTime = new Date().toISOString();
                
                this.app.userData.health.waterLog.push({
                    time: new Date().toISOString(),
                    count: this.waterCount
                });
                
                this.app.saveUserData();
                this.updateHealthUI();
                
                this.app.showNotification('Ø¢Ø¨ Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ', 
                    `Ø¢ÙØ±ÛŒÙ†! Ù„ÛŒÙˆØ§Ù† ${this.waterCount} Ø¢Ø¨ Ø§Ù…Ø±ÙˆØ² Ø«Ø¨Øª Ø´Ø¯.
                    
                    Ù‡Ø¯Ù Ø±ÙˆØ²Ø§Ù†Ù‡: Û¸ Ù„ÛŒÙˆØ§Ù†
                    Ù¾ÛŒØ´Ø±ÙØª: ${Math.round((this.waterCount / 8) * 100)}%`);
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ú†Ø§Ù„Ø´
                this.app.challengeManager.updateChallengeProgress('water', 1);
                
                // Ø§ÙØ²ÙˆØ¯Ù† ØªØ¬Ø±Ø¨Ù‡
                this.app.addTreeExperience(5);
            }
            
            checkPosture() {
                const score = Math.floor(Math.random() * 20) + 80; // 80-100
                this.app.userData.tree.postureScore = score;
                this.app.userData.tree.lastPostureCheck = new Date().toISOString();
                
                this.app.userData.health.postureChecks.push({
                    time: new Date().toISOString(),
                    score: score
                });
                
                this.app.saveUserData();
                this.updateHealthUI();
                
                let message = '';
                if (score >= 90) {
                    message = 'Ø¹Ø§Ù„ÛŒ! ÙˆØ¶Ø¹ÛŒØª Ù†Ø´Ø³ØªÙ† Ø´Ù…Ø§ Ø¨Ø³ÛŒØ§Ø± Ø®ÙˆØ¨ Ø§Ø³Øª.';
                } else if (score >= 80) {
                    message = 'Ø®ÙˆØ¨ Ø§Ø³ØªØŒ Ø§Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ù‡ØªØ± Ø´ÙˆØ¯.';
                } else {
                    message = 'Ù„Ø·ÙØ§Ù‹ ÙˆØ¶Ø¹ÛŒØª Ù†Ø´Ø³ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ Ø§ØµÙ„Ø§Ø­ Ú©Ù†ÛŒØ¯.';
                }
                
                this.app.showNotification('Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù†Ø´Ø³ØªÙ†', 
                    `Ø§Ù…ØªÛŒØ§Ø² Ø´Ù…Ø§: ${score}%
                    
                    ${message}
                    
                    Ù†Ú©Ø§Øª:
                    Û±. Ù¾Ø´Øª ØµÙ†Ø¯Ù„ÛŒ Ø±Ø§ Ú©Ø§Ù…Ù„ Ù¾Ø± Ú©Ù†ÛŒØ¯
                    Û². Ø²Ø§Ù†ÙˆÙ‡Ø§ Ø¯Ø± Ø±Ø§Ø³ØªØ§ÛŒ Ù„Ú¯Ù†
                    Û³. ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø³Ø·Ø­ Ú†Ø´Ù…
                    Û´. Ø³Ø§Ø¹Ø¯â€ŒÙ‡Ø§ Ù…ÙˆØ§Ø²ÛŒ Ø²Ù…ÛŒÙ†`);
            }
            
            checkHealthReminders() {
                if (!this.app.userData.settings.eyeBreak && !this.app.userData.settings.stretchBreak) {
                    return;
                }
                
                const now = new Date();
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…
                if (this.app.userData.settings.eyeBreak) {
                    const lastEyeBreak = this.app.userData.health.lastEyeBreak ? 
                        new Date(this.app.userData.health.lastEyeBreak) : new Date(0);
                    const eyeBreakDiff = (now - lastEyeBreak) / 60000; // Ø¯Ù‚ÛŒÙ‚Ù‡
                    
                    if (eyeBreakDiff >= 20 && this.app.timer && this.app.timer.isRunning) {
                        this.app.addNotification({
                            title: 'Ø²Ù…Ø§Ù† Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù…',
                            message: 'Û²Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø² Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø´Ù…Ø§ Ú¯Ø°Ø´ØªÙ‡. Ù„Ø·ÙØ§Ù‹ Ø§Ø³ØªØ±Ø§Ø­Øª Ú†Ø´Ù… Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.',
                            time: 'Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†',
                            read: false,
                            type: 'health'
                        });
                    }
                }
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ
                if (this.app.userData.settings.stretchBreak) {
                    const lastStretchBreak = this.app.userData.health.lastStretchBreak ? 
                        new Date(this.app.userData.health.lastStretchBreak) : new Date(0);
                    const stretchBreakDiff = (now - lastStretchBreak) / 60000; // Ø¯Ù‚ÛŒÙ‚Ù‡
                    
                    if (stretchBreakDiff >= 60 && this.app.timer && this.app.timer.isRunning) {
                        this.app.addNotification({
                            title: 'Ø²Ù…Ø§Ù† Ú©Ø´Ø´ Ø¨Ø¯Ù†ÛŒ',
                            message: 'Û± Ø³Ø§Ø¹Øª Ø§Ø² Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø´Ù…Ø§ Ú¯Ø°Ø´ØªÙ‡. Ù„Ø·ÙØ§Ù‹ Ø­Ø±Ú©Ø§Øª Ú©Ø´Ø´ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.',
                            time: 'Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†',
                            read: false,
                            type: 'health'
                        });
                    }
                }
            }
        }
        
        // ============================================
        // Ú©Ù„Ø§Ø³ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù…Ø§Ø±
        // ============================================
        class StatsManager {
            constructor(app) {
                this.app = app;
            }
            
            initialize() {
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ù…Ø§Ø± Ø§ÙˆÙ„ÛŒÙ‡
                this.updateStudyStats();
            }
            
            updateStudyStats() {
                const stats = this.app.userData.stats;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² ØªÙ…Ø±Ú©Ø²
                if (stats.totalSessions > 0) {
                    const avgSessionTime = stats.totalStudyTime / stats.totalSessions;
                    stats.focusScore = Math.min(100, Math.round(avgSessionTime / 25 * 100));
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ¯Ø§ÙˆÙ…
                if (stats.studyDays) {
                    const totalDays = Object.keys(stats.studyDays).length;
                    if (totalDays > 0) {
                        const studyDaysCount = Object.values(stats.studyDays).filter(time => time > 0).length;
                        stats.consistency = Math.round((studyDaysCount / totalDays) * 100);
                    }
                }
                
                this.app.saveUserData();
            }
        }
        
        // ============================================
        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø²ÙˆÙ… Ø¯Ùˆ Ø§Ù†Ú¯Ø´ØªÛŒ
            document.addEventListener('gesturestart', function(e) {
                e.preventDefault();
            });
            
            // Ø§ÛŒØ¬Ø§Ø¯ instance Ø¨Ø±Ù†Ø§Ù…Ù‡
            window.app = new MStudyPro();
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø³Ø§Ø²Ù†Ø¯Ù‡
            console.log('%cğŸ”¥ MStudy Pro v3.0.0 ğŸ”¥', 'font-size: 24px; color: #6a11cb; font-weight: bold;');
            console.log('%cØ·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø·: Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø´Ø±Ú©Ø§Ø¦ÛŒ', 'font-size: 14px; color: #8a4bff;');
            console.log('%cØ¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ù…Ø¯Ø±Ø³Ù‡ Ù…Ù‡Ø± Ø¢ÙØ±ÛŒÙ†Ø§Ù†', 'font-size: 12px; color: #999;');
            console.log('%cÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯: Ø³ÛŒØ³ØªÙ… Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯ØŒ Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ØŒ Ø³Ù„Ø§Ù…Øª Ù…Ø·Ø§Ù„Ø¹Ù‡', 'font-size: 12px; color: #666;');
            
            // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù‚Ø¨Ù„ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† ØµÙØ­Ù‡
            window.addEventListener('beforeunload', (e) => {
                if (window.app.timer && window.app.timer.isRunning) {
                    e.preventDefault();
                    e.returnValue = 'ØªØ§ÛŒÙ…Ø± Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª. Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø®Ø§Ø±Ø¬ Ø´ÙˆÛŒØ¯ØŸ';
                    window.app.storage.emergencySave(window.app.userData);
                }
            });
        });
    </script>
</body>
</html>